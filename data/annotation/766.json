{"content": "Last week we first tweeted that the GuardiCore Global Sensor Network (GGSN) has detected a wide ransomware attack targeting MySQL databases. The attacks look like an evolution of the MongoDB ransomware attacks first reported earlier this year by Victor Gevers. Similarly to the MongoDB attacks, owners are instructed to pay a 0.2 Bitcoin ransom (approx.$200) to regain access to their content. We saw two very similar variations of the attack using two bitcoin wallets. In this post we will describe in detail the attack flow and provide some recommendations on how to protect your databases from similar attacks along with attack IoCs. The attacks started at midnight at 00:15 on February 12 and lasted about 30 hours in which hundreds of attacks were reported by GGSN. We were able to trace all the attacks\u00a0to 109.236.88.20, an IP address hosted by worldstream.nl, a Netherlands-based web hosting company. The attacker is (probably) running from a compromised mail server which also serves as HTTP(s) and FTP server. Worldstream was notified a few days after we reported the attack. The attack starts with \u2018root\u2019 password brute-forcing. Once logged-in, it fetches a list of the existing MySQL databases and their tables and creates a new table called \u2018WARNING\u2019 that includes a contact email address, a bitcoin address and a payment demand. In one variant of the attack the table is added to an existing database; in other cases the table is added to a newly created database called \u2018PLEASE_READ\u2019. The attacker will then delete the databases stored on the server and disconnect, sometimes without even dumping them first. The attack as reported by GuardiCore Centra We logged two versions of the ransom message: INSERT INTO PLEASE_READ.`WARNING`(id, warning, Bitcoin_Address, Email) VALUES(\u20181\u2032,\u2019Send 0.2 BTC to this address and contact this email with your ip or db_name of your server to recover your database! Your DB is Backed up to our servers!\u2019, \u20181ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY\u2019, \u2018backupservice@mail2tor.com\u2019) INSERT INTO `WARNING`(id, warning) VALUES(1, \u2018SEND 0.2 BTC TO THIS ADDRESS 1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9 AND GO TO THIS SITE http://sognd75g4isasu2v.onion/ TO RECOVER YOUR DATABASE! The second version offers the owner to visit the following darknet web site \u2018http://sognd75g4isasu2v.onion/\u2019 to recover the lost data. The darknet web site referenced in the ransom note. Each version uses a different bitcoin wallet, 1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9 vs 1ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY\u00a0and\u00a0based on Blockchain public information people have been paying up.", "sourcefile": "766.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E4", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 302, "index": "T7", "endOffset": 323, "text": "are instructed to pay"}, "argument": [{"index": "T8", "external_reference": {"wikidataid": "Q131723"}, "endOffset": 337, "role": {"type": "Price"}, "text": "0.2 Bitcoin", "startOffset": 326, "type": "Money"}, {"index": "T6", "text": "owners", "endOffset": 301, "role": {"type": "Victim"}, "startOffset": 295, "type": "Person"}, {"index": "T15", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/MongoDB"}, "endOffset": 285, "role": {"type": "Victim"}, "text": "MongoDB", "startOffset": 278, "type": "System"}], "subtype": "Ransom"}, {"index": "E5", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 338, "index": "T9", "endOffset": 344, "text": "ransom"}, "argument": [{"index": "T10", "text": "$200", "endOffset": 357, "role": {"type": "Price"}, "startOffset": 353, "type": "Money"}], "subtype": "Ransom"}, {"nugget": {"startOffset": 286, "index": "T16", "endOffset": 293, "text": "attacks"}, "index": "E8", "type": "Attack", "subtype": "Ransom", "realis": "Generic"}]}, {"index": 1, "relation": "Same", "events": [{"nugget": {"startOffset": 141, "index": "T3", "endOffset": 152, "text": "The attacks"}, "index": "E2", "type": "Attack", "subtype": "Ransom", "realis": "Generic"}, {"index": "E3", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 179, "index": "T4", "endOffset": 209, "text": "the MongoDB ransomware attacks"}, "argument": [{"index": "T5", "text": "earlier this year", "endOffset": 242, "role": {"type": "Time"}, "startOffset": 225, "type": "Time"}], "subtype": "Ransom"}]}, {"index": 2, "events": [{"index": "E1", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 89, "index": "T1", "endOffset": 113, "text": "a wide ransomware attack"}, "argument": [{"index": "T2", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/MySQL"}, "endOffset": 139, "role": {"type": "Victim"}, "text": "MySQL databases", "startOffset": 124, "type": "System"}], "subtype": "Ransom"}]}, {"index": 3, "events": [{"index": "E6", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 432, "index": "T11", "endOffset": 442, "text": "the attack"}, "argument": [{"index": "T12", "text": "two bitcoin wallets", "endOffset": 468, "role": {"type": "Payment-Method"}, "startOffset": 449, "type": "PaymentMethod"}], "subtype": "Ransom"}]}, {"index": 4, "events": [{"index": "E7", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1324, "index": "T13", "endOffset": 1340, "text": "a payment demand"}, "argument": [{"index": "T14", "text": "a bitcoin address", "endOffset": 1319, "role": {"type": "Payment-Method"}, "startOffset": 1302, "type": "PaymentMethod"}], "subtype": "Ransom"}]}]}, "info": {"title": "0.2 BTC Strikes Back, Now Attacking MySQL Databases - GuardiCore - Data Center and Cloud Security", "date": "2017_02_27", "type": "text", "link": "https://www.guardicore.com/2017/02/0-2-btc-strikes-back-now-attacking-mysql-databases/"}}