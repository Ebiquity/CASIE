{"content": "Back in August we wrote about a security bugfix for Mikrotik routers that was reverse engineered and turned into a working exploit. Indeed, patches that fix security vulnerabilities often end up giving away enough about the vulnerability that both good guys and bad guys alike can weaponise it from first principles \u2013 all without having to figure out the vulnerability in the first place. In the August 2018 case, dubbed CVE-2018-14847, a crook could trick an unpatched Microtik router into coughing up the contents of any file on the device, including the password file. Worse still, the password file included plaintext passwords, with no salting, hashing or stretching, meaning that a security bypass bug could be parlayed into a credential compromise.  The perils of late patching What we didn\u2019t know back then was that security researchers at Tenable had responsibly disclosed another bunch of Mikrotik router bugs at about the same time. These bugs were serious \u2013 indeed, one of them allows a attacker to run any program of their choosing, just by making a web request to the router. This sort of hole is known, for rather obvious reasons, as an RCE, short for Remote Code Execution. Tenable\u2019s bugs, however, were what\u2019s known as \u201cauthenticated vulnerabilities\u201d, meaning that you had to be logged in first in order to be able to exploit them. Security holes that require pre-authentication may seem harmless at first sight \u2013 after all, if you already have a username and password, or some other access token, that gives you access to a system\u2026 \u2026well, you\u2019re already in, so it sounds as though breaking in again can be dismissed as an irrelevancy. The good news is that Mikrotik has already patched Tenable\u2019s now-disclosed bugs, dubbed CVE-2018-1156, -1157, -1158 and -1159. Make sure you have the latest Mikrotik firmware updates, which are: 6.40.9, 6.42.7 or 6.43, depending on whether you\u2019re using the current, previous or pre-previous version. If you\u2019re a Mikrotik user, skipping the latest patch leaves you at risk, but if you still haven\u2019t applied the previous patch, you\u2019re in double trouble. With both patches missing, you\u2019re open to an unauthenticated password disclosure bug that could then be chained with the newer authenticated remote code execution bug. In other words, instead of anyone being able to get some access, or some people being able to get full access, anyone could get full access by pivoting from CVE-2018-14847 to CVE-2018-1156, the RCE flaw.", "sourcefile": "10172.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 153, "index": "T4", "endOffset": 156, "text": "fix"}, "argument": [{"index": "T5", "text": "security vulnerabilities", "endOffset": 181, "role": {"type": "Vulnerability"}, "startOffset": 157, "type": "Vulnerability"}, {"index": "T3", "text": "patches", "endOffset": 147, "role": {"type": "Patch"}, "startOffset": 140, "type": "Patch"}, {"index": "T2", "text": "a security bugfix", "endOffset": 47, "role": {"type": "Patch"}, "startOffset": 30, "type": "Patch"}, {"index": "T1", "text": "Mikrotik routers", "endOffset": 68, "role": {"type": "Vulnerable_System"}, "startOffset": 52, "type": "Device"}, {"index": "T21", "text": "a working exploit", "endOffset": 130, "role": {"type": "Vulnerability"}, "startOffset": 113, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1684, "index": "T10", "endOffset": 1703, "text": "has already patched"}, "argument": [{"index": "T12", "external_reference": {"wikidataid": "Q913580"}, "endOffset": 1683, "role": {"type": "Releaser"}, "text": "Mikrotik", "startOffset": 1675, "type": "Organization"}, {"index": "T11", "text": "Tenable\u2019s now-disclosed bugs", "endOffset": 1732, "role": {"type": "Vulnerability"}, "startOffset": 1704, "type": "Vulnerability"}, {"index": "T13", "text": "CVE-2018-1156", "endOffset": 1754, "role": {"type": "CVE"}, "startOffset": 1741, "type": "CVE"}, {"index": "T14", "text": "-1157", "endOffset": 1761, "role": {"type": "CVE"}, "startOffset": 1756, "type": "CVE"}, {"index": "T15", "text": "-1158", "endOffset": 1768, "role": {"type": "CVE"}, "startOffset": 1763, "type": "CVE"}, {"index": "T16", "text": "-1159", "endOffset": 1778, "role": {"type": "CVE"}, "startOffset": 1773, "type": "CVE"}, {"index": "T17", "text": "the latest Mikrotik firmware updates", "endOffset": 1835, "role": {"type": "Patch"}, "startOffset": 1799, "type": "Patch"}, {"index": "T18", "text": "6.40.9", "endOffset": 1854, "role": {"type": "Patch-Number"}, "startOffset": 1848, "type": "Version"}, {"index": "T19", "text": "6.42.7", "endOffset": 1862, "role": {"type": "Patch-Number"}, "startOffset": 1856, "type": "Version"}, {"index": "T20", "text": "6.43", "endOffset": 1870, "role": {"type": "Patch-Number"}, "startOffset": 1866, "type": "Version"}], "subtype": "PatchVulnerability"}]}, {"index": 1, "events": [{"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 856, "index": "T7", "endOffset": 881, "text": "had responsibly disclosed"}, "argument": [{"index": "T9", "text": "security researchers", "endOffset": 844, "role": {"type": "Discoverer"}, "startOffset": 824, "type": "Person"}, {"index": "T8", "text": "Mikrotik router bugs", "endOffset": 919, "role": {"type": "Vulnerability"}, "startOffset": 899, "type": "Vulnerability"}, {"index": "T6", "external_reference": {"wikidataid": "Q55948312"}, "endOffset": 855, "role": {"type": "Discoverer"}, "text": "Tenable", "startOffset": 848, "type": "Organization"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "Unpatched routers bad, doubly unpatched routers worse \u2013 much, much worse!", "date": "2018_10_08", "type": "text", "link": "https://nakedsecurity.sophos.com/2018/10/08/unpatched-routers-bad-doubly-unpatched-routers-worse-much-much-worse/"}}