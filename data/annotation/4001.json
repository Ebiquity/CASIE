{"content": "A security flaw affecting LibreOffice and Apache OpenOffice has been fixed in one of the two open-source office suites. The other still appears to be vulnerable. Before attempting to guess which app has yet to be patched, consider that Apache OpenOffice for years has struggled attract more contributors. And though the number of people adding code to the project has grown since last we checked, the project missed its recent January report to the Apache Foundation. The upshot is: security holes aren't being patched, it seems. The issue, identified by security researcher Alex Inf\u00fchr, is that there's a way to achieve remote code execution by triggering an event embedded in an ODT (OpenDocument Text) file. In a blog post on Friday, Inf\u00fchr explains how he found a way to abuse the OpenDocument scripting framework by adding an onmouseover event to a link in an ODT file. The event, which fires when a user's mouse pointer moves over the link, can traverse local directories and execute a local Python script. After trying various approaches to exploit the vulnerability, Inf\u00fchr found that he could rig the event to call a specific function within a Python file included with the Python interpreter that ships with LibreOffice. \"For the solution I looked into the Python parsing code a little more in depth and discovered that it is not only possible to specify the function you want to call inside a python script, but it is possible to pass parameters as well,\" he said. The exploit was tested on Windows, and should work on Linux, too. Inf\u00fchr says he reported the bug on October 18 and it was fixed in LibreOffice by the end of the month. RedHat assigned it CVE-2018-16858 in mid-November and gave Inf\u00fchr a disclosure date of January 31, 2019. When he published on February 1, in conjunction with the LibreOffice fix notification, OpenOffice still had not been patched. Inf\u00fchr says he reconfirmed that he could go ahead with disclosure even though OpenOffice 4.16 has yet to be fixed. His proof-of-concept exploit doesn't work with OpenOffice out-of-the-box because the software doesn't allow parameters to be passed in the same way as the unpatched version of LibreOffice did. However, he says that the path traversal issue can still be abused to execute a local Python file and cause further mischief and damage. We're imagining specifically targeted netizens being tricked into opening a ZIP file, unpacking an ODT and Python script, and then the ODT document attempting to execute the Python script when the victim rolls their mouse over a link, for instance. The Register tried to reach two OpenOffice contributors to find out what's going on. We've not heard back. According to Inf\u00fchr, OpenOffice users can mitigate the risk by removing or renaming the pythonscript.py file in the installation folder.", "sourcefile": "4001.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 16, "index": "T2", "endOffset": 25, "text": "affecting"}, "argument": [{"index": "T1", "text": "A security flaw", "endOffset": 15, "role": {"type": "Vulnerability"}, "startOffset": 0, "type": "Vulnerability"}, {"index": "T3", "external_reference": {"wikidataid": "Q10135"}, "endOffset": 37, "role": {"type": "Vulnerable_System"}, "text": "LibreOffice", "startOffset": 26, "type": "Software"}, {"index": "T4", "external_reference": {"wikidataid": "Q2858086"}, "endOffset": 59, "role": {"type": "Vulnerable_System"}, "text": "Apache OpenOffice", "startOffset": 42, "type": "Software"}], "subtype": "DiscoverVulnerability"}, {"nugget": {"startOffset": 147, "index": "T7", "endOffset": 160, "text": "be vulnerable"}, "index": "E3", "type": "Vulnerability-related", "subtype": "DiscoverVulnerability", "realis": "Actual"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E13", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1652, "index": "T37", "endOffset": 1660, "text": "assigned"}, "argument": [{"index": "T38", "text": "CVE-2018-16858", "endOffset": 1678, "role": {"type": "CVE"}, "startOffset": 1664, "type": "CVE"}, {"index": "T39", "text": "mid-November", "endOffset": 1694, "role": {"type": "Time"}, "startOffset": 1682, "type": "Time"}, {"index": "T36", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Red_Hat", "wikidataid": "Q485593"}, "endOffset": 1651, "role": {"type": "Discoverer"}, "text": "RedHat", "startOffset": 1645, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E14", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1713, "index": "T41", "endOffset": 1723, "text": "disclosure"}, "argument": [{"index": "T42", "text": "January 31, 2019", "endOffset": 1748, "role": {"type": "Time"}, "startOffset": 1732, "type": "Time"}, {"index": "T40", "text": "Inf\u00fchr", "endOffset": 1710, "role": {"type": "Discoverer"}, "startOffset": 1704, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E15", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1758, "index": "T44", "endOffset": 1767, "text": "published"}, "argument": [{"index": "T45", "text": "February 1", "endOffset": 1781, "role": {"type": "Time"}, "startOffset": 1771, "type": "Time"}, {"index": "T43", "text": "he", "endOffset": 1757, "role": {"type": "Discoverer"}, "startOffset": 1755, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1549, "index": "T29", "endOffset": 1553, "text": "says"}, "argument": [{"index": "T28", "text": "Inf\u00fchr", "endOffset": 1548, "role": {"type": "Discoverer"}, "startOffset": 1542, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1557, "index": "T30", "endOffset": 1565, "text": "reported"}, "argument": [{"index": "T31", "text": "he", "endOffset": 1556, "role": {"type": "Discoverer"}, "startOffset": 1554, "type": "Person"}, {"index": "T26", "text": "the bug", "endOffset": 1573, "role": {"type": "Vulnerability"}, "startOffset": 1566, "type": "Vulnerability"}, {"index": "T27", "text": "October 18", "endOffset": 1587, "role": {"type": "Time"}, "startOffset": 1577, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 744, "index": "T16", "endOffset": 752, "text": "explains"}, "argument": [{"index": "T17", "text": "Inf\u00fchr", "endOffset": 743, "role": {"type": "Discoverer"}, "startOffset": 737, "type": "Person"}, {"index": "T18", "text": "Friday", "endOffset": 735, "role": {"type": "Time"}, "startOffset": 729, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 760, "index": "T20", "endOffset": 765, "text": "found"}, "argument": [{"index": "T21", "text": "abuse the OpenDocument scripting framework", "endOffset": 817, "role": {"CAPEC-Meta": "Code Injection", "type": "Capabilities", "confidence": 0.9012262523174286}, "startOffset": 775, "type": "Capabilities"}, {"index": "T19", "text": "he", "endOffset": 759, "role": {"type": "Discoverer"}, "startOffset": 757, "type": "Person"}, {"index": "T69", "text": "adding an onmouseover event to a link in an ODT file", "endOffset": 873, "role": {"CAPEC-Meta": "Buffer Manipulation", "type": "Capabilities", "confidence": 0.9044958055019379}, "startOffset": 821, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 541, "index": "T14", "endOffset": 551, "text": "identified"}, "argument": [{"index": "T15", "text": "security researcher Alex Inf\u00fchr", "endOffset": 586, "role": {"type": "Discoverer"}, "startOffset": 555, "type": "Person"}, {"index": "T13", "text": "issue", "endOffset": 539, "role": {"type": "Vulnerability"}, "startOffset": 534, "type": "Vulnerability"}, {"index": "T68", "text": "achieve remote code execution by triggering an event embedded in an ODT (OpenDocument Text) file", "endOffset": 709, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9498706758022308}, "startOffset": 613, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1082, "index": "T23", "endOffset": 1087, "text": "found"}, "argument": [{"index": "T24", "text": "vulnerability", "endOffset": 1073, "role": {"type": "Vulnerability"}, "startOffset": 1060, "type": "Vulnerability"}, {"index": "T22", "text": "Inf\u00fchr", "endOffset": 1081, "role": {"type": "Discoverer"}, "startOffset": 1075, "type": "Person"}, {"index": "T25", "external_reference": {"wikidataid": "Q10135"}, "endOffset": 1229, "role": {"type": "Vulnerable_System"}, "text": "LibreOffice", "startOffset": 1218, "type": "Software"}], "subtype": "DiscoverVulnerability"}, {"index": "E20", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1883, "index": "T53", "endOffset": 1887, "text": "says"}, "argument": [{"index": "T51", "text": "Inf\u00fchr", "endOffset": 1882, "role": {"type": "Discoverer"}, "startOffset": 1876, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E19", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1891, "index": "T52", "endOffset": 1902, "text": "reconfirmed"}, "argument": [{"index": "T55", "text": "he", "endOffset": 1890, "role": {"type": "Discoverer"}, "startOffset": 1888, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E18", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1931, "index": "T50", "endOffset": 1941, "text": "disclosure"}, "argument": [{"index": "T54", "text": "he", "endOffset": 1910, "role": {"type": "Discoverer"}, "startOffset": 1908, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E21", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2196, "index": "T60", "endOffset": 2200, "text": "says"}, "argument": [{"index": "T61", "text": "he", "endOffset": 2195, "role": {"type": "Discoverer"}, "startOffset": 2193, "type": "Person"}, {"index": "T58", "text": "path traversal issue", "endOffset": 2230, "role": {"type": "Vulnerability"}, "startOffset": 2210, "type": "Vulnerability"}, {"index": "T59", "text": "abused to execute a local Python file", "endOffset": 2281, "role": {"CAPEC-Meta": "File Manipulation", "type": "Capabilities", "confidence": 0.9311875998973846}, "startOffset": 2244, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "relation": "Same", "events": [{"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 60, "index": "T5", "endOffset": 74, "text": "has been fixed"}, "argument": [{"index": "T6", "external_reference": {"wikidataid": "Q39162"}, "endOffset": 118, "role": {"type": "Vulnerable_System"}, "text": "open-source office suites", "startOffset": 93, "type": "Software"}, {"index": "T4", "external_reference": {"wikidataid": "Q2858086"}, "endOffset": 59, "role": {"type": "Vulnerable_System"}, "text": "Apache OpenOffice", "startOffset": 42, "type": "Software"}, {"index": "T3", "external_reference": {"wikidataid": "Q10135"}, "endOffset": 37, "role": {"type": "Vulnerable_System"}, "text": "LibreOffice", "startOffset": 26, "type": "Software"}, {"index": "T1", "text": "A security flaw", "endOffset": 15, "role": {"type": "Vulnerability"}, "startOffset": 0, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 210, "index": "T9", "endOffset": 220, "text": "be patched"}, "argument": [{"index": "T8", "external_reference": {"wikidataid": "Q166142"}, "endOffset": 198, "role": {"type": "Vulnerable_System"}, "text": "app", "startOffset": 195, "type": "Software"}, {"index": "T10", "external_reference": {"wikidataid": "Q2858086"}, "endOffset": 253, "role": {"type": "Vulnerable_System"}, "text": "Apache OpenOffice", "startOffset": 236, "type": "Software"}], "subtype": "PatchVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 505, "index": "T12", "endOffset": 518, "text": "being patched"}, "argument": [{"index": "T11", "text": "security holes", "endOffset": 497, "role": {"type": "Vulnerability"}, "startOffset": 483, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1595, "index": "T32", "endOffset": 1604, "text": "was fixed"}, "argument": [{"index": "T33", "text": "it", "endOffset": 1594, "role": {"type": "Vulnerability"}, "startOffset": 1592, "type": "Vulnerability"}, {"index": "T26", "text": "the bug", "endOffset": 1573, "role": {"type": "Vulnerability"}, "startOffset": 1566, "type": "Vulnerability"}, {"index": "T35", "text": "end of the month", "endOffset": 1643, "role": {"type": "Time"}, "startOffset": 1627, "type": "Time"}, {"index": "T34", "external_reference": {"wikidataid": "Q10135"}, "endOffset": 1619, "role": {"type": "Vulnerable_System"}, "text": "LibreOffice", "startOffset": 1608, "type": "Software"}], "subtype": "PatchVulnerability"}, {"index": "E16", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 1862, "index": "T46", "endOffset": 1874, "text": "been patched"}, "argument": [{"index": "T47", "external_reference": {"wikidataid": "Q511977"}, "endOffset": 1847, "role": {"type": "Vulnerable_System"}, "text": "OpenOffice", "startOffset": 1837, "type": "Software"}, {"index": "T48", "text": "the LibreOffice fix", "endOffset": 1822, "role": {"type": "Patch"}, "startOffset": 1803, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E17", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1981, "index": "T49", "endOffset": 1989, "text": "be fixed"}, "argument": [{"index": "T57", "text": "4.16", "endOffset": 1969, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 1965, "type": "Version"}, {"index": "T56", "external_reference": {"wikidataid": "Q511977"}, "endOffset": 1964, "role": {"type": "Vulnerable_System"}, "text": "OpenOffice", "startOffset": 1954, "type": "Software"}], "subtype": "PatchVulnerability"}]}, {"index": 3, "events": [{"index": "E22", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 2368, "index": "T62", "endOffset": 2381, "text": "being tricked"}, "argument": [{"index": "T63", "text": "netizens", "endOffset": 2367, "role": {"type": "Victim"}, "startOffset": 2359, "type": "Person"}, {"index": "T64", "text": "opening a ZIP file", "endOffset": 2405, "role": {"CAPEC-Meta": "File Manipulation", "type": "Attack-Pattern", "confidence": 0.880915492773056}, "startOffset": 2387, "type": "Capabilities"}, {"index": "T65", "text": "unpacking an ODT and Python script", "endOffset": 2441, "role": {"CAPEC-Meta": "Code Injection", "type": "Attack-Pattern", "confidence": 0.8815415501594543}, "startOffset": 2407, "type": "Capabilities"}, {"index": "T66", "text": "execute the Python script", "endOffset": 2508, "role": {"type": "Purpose", "subtype": "Malware spreading", "confidence": 0.8823572397232056}, "startOffset": 2483, "type": "Purpose"}, {"index": "T67", "text": "the victim", "endOffset": 2524, "role": {"type": "Attacker"}, "startOffset": 2514, "type": "Person"}], "subtype": "Phishing"}]}]}, "info": {"title": "LibreOffice patches malicious code-execution bug, Apache OpenOffice \u2013 wait for it, wait for it \u2013 doesn't", "date": "2019_02_04", "type": "text", "link": "https://www.theregister.co.uk/2019/02/04/apache_openoffice_no_patch/"}}