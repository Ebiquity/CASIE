{"content": "Having had more than a week to digest Cloudbleed\u2019s causes and impact, Cloudflare CEO Matthew Prince assessed the damage yesterday in a lengthy post-mortem as relatively low. Prince said there is no evidence the vulnerability, which leaked customer data from memory, was exploited by attackers. The bug, however, was triggered more than 1.2 million times from 6,500 sites that met the criteria under which it could be exploited. In the meantime, Cloudflare continues to work with Google and other search engine providers to scrub cached sites that could contain any leaked data from memory. \u201cWe\u2019ve successfully removed more than 80,000 unique cached pages. That underestimates the total number because we\u2019ve requested search engines purge and recrawl entire sites in some instances,\u201d Prince said. Prince said leaks have included internal Cloudflare headers and customer cookies, but no evidence of passwords, encryption keys, payment card data or health records among the leaks. The vulnerability was privately disclosed Feb 17 by Google Project Zero researcher Tavis Ormandy, who reported that he did see crypto keys, passwords, POST data and HTTPS requests for other Cloudflare-hosted sites among data from other requests. Ormandy initially said in a tweet that Cloudflare was leaking customer HTTPS sessions for Uber, FitBit, OKCupid and others, all of which said the impact of Cloudbleed on their data was minimal. \u201cWhile the bug was very bad and had the potential to be much worse,\u201d Prince said. Prince explained that the bug was triggered only when a webpage moving through the Cloudflare network contained HTML ending with an un-terminated attribute, and if a number of Cloudflare features were turned on. Those features hand in hand with a Cloudflare stream parser used to scan and modify content in real time such as rewriting HTTP links to HTTPS\u2014a feature called Automatic HTTPS Rewrites\u2014or hiding email addresses on a page from spammers\u2014a feature called Email Address Obfuscation. The need to end with an un-terminated attribute was key. \u201cWhen a page for a particular customer is being parsed it is stored in memory on one of the servers that is a part of our infrastructure. Contents of the other customers\u2019 requests are also in adjacent portions of memory on Cloudflare\u2019s servers,\u201d Prince said. \u201cThe bug caused the parser, when it encountered un-terminated attribute at the end of a page, to not stop when it reached the end of the portion of memory for the particular page being parsed. Instead, the parser continued to read from adjacent memory, which contained data from other customers\u2019 requests. The contents of that adjacent memory were then dumped onto the page with the flawed HTML\u201d. Anyone accessing one of those pages would see the memory dump, looking a lot like random text, below, Prince said. An attacker would need to pound one of those sites with numerous requests to trigger the bug and then record the results, getting a mix of useless data and sensitive information, Prince said. \u201cThe nightmare scenario we have been worried about is if a hacker had been aware of the bug and had been quietly mining data before we were notified by Google\u2019s Project Zero team and were able to patch it,\u201d Prince said. \u201cFor the last 12 days we\u2019ve been reviewing our logs to see if there\u2019s any evidence to indicate that a hacker was exploiting the bug before it was patched. We\u2019ve found nothing so far to indicate that was the case\u201d. Prince said Cloudflare customers who find any leaked cached data can send a link to the caches to parserbug@cloudflare[.]com. Over 2,000 WordPress sites are infected as part of a keylogger campaign that leverages an old malicious script.", "sourcefile": "872.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E3", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 967, "index": "T8", "endOffset": 976, "text": "the leaks"}, "argument": [{"index": "T12", "text": "passwords", "endOffset": 906, "role": {"type": "Compromised-Data"}, "startOffset": 897, "type": "PII"}, {"index": "T11", "text": "encryption keys", "endOffset": 923, "role": {"type": "Compromised-Data"}, "startOffset": 908, "type": "Data"}, {"index": "T10", "text": "payment card data", "endOffset": 942, "role": {"type": "Compromised-Data"}, "startOffset": 925, "type": "PII"}, {"index": "T9", "text": "health records", "endOffset": 960, "role": {"type": "Compromised-Data"}, "startOffset": 946, "type": "PII"}], "subtype": "Databreach"}, {"index": "E5", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 1274, "index": "T17", "endOffset": 1285, "text": "was leaking"}, "argument": [{"index": "T18", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Cloudflare", "wikidataid": "Q4778915"}, "endOffset": 1273, "role": {"type": "Attacker"}, "text": "Cloudflare", "startOffset": 1263, "type": "Organization"}, {"index": "T19", "text": "customer", "endOffset": 1294, "role": {"type": "Victim"}, "startOffset": 1286, "type": "Person"}, {"index": "T20", "text": "HTTPS sessions", "endOffset": 1309, "role": {"type": "Compromised-Data"}, "startOffset": 1295, "type": "Data"}, {"index": "T21", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Uber_Cup"}, "endOffset": 1318, "role": {"type": "Victim"}, "text": "Uber", "startOffset": 1314, "type": "Organization"}, {"index": "T22", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Fitbit", "wikidataid": "Q5455414"}, "endOffset": 1326, "role": {"type": "Victim"}, "text": "FitBit", "startOffset": 1320, "type": "Organization"}, {"index": "T23", "external_reference": {"wikidataid": "Q1138914"}, "endOffset": 1335, "role": {"type": "Victim"}, "text": "OKCupid", "startOffset": 1328, "type": "Organization"}], "subtype": "Databreach"}, {"index": "E6", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 2650, "index": "T24", "endOffset": 2666, "text": "were then dumped"}, "argument": [{"index": "T25", "text": "The contents", "endOffset": 2625, "role": {"type": "Compromised-Data"}, "startOffset": 2613, "type": "Data"}], "subtype": "Databreach"}]}, {"index": 1, "relation": "Same", "events": [{"nugget": {"startOffset": 3194, "index": "T26", "endOffset": 3212, "text": "were able to patch"}, "index": "E7", "type": "Vulnerability-related", "subtype": "PatchVulnerability", "realis": "Other"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3373, "index": "T31", "endOffset": 3384, "text": "was patched"}, "argument": [{"index": "T30", "text": "it", "endOffset": 3372, "role": {"type": "Vulnerability"}, "startOffset": 3370, "type": "Vulnerability"}, {"index": "T32", "text": "the bug", "endOffset": 3362, "role": {"type": "Vulnerability"}, "startOffset": 3355, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}]}, {"index": 2, "relation": "Same", "events": [{"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3146, "index": "T28", "endOffset": 3159, "text": "were notified"}, "argument": [{"index": "T27", "text": "the bug", "endOffset": 3102, "role": {"type": "Vulnerability"}, "startOffset": 3095, "type": "Vulnerability"}, {"index": "T29", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Google", "wikidataid": "Q95"}, "endOffset": 3169, "role": {"type": "Discoverer"}, "text": "Google", "startOffset": 3163, "type": "Organization"}, {"index": "T33", "text": "Project Zero team", "endOffset": 3189, "role": {"type": "Discoverer"}, "startOffset": 3172, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E12", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 3340, "index": "T38", "endOffset": 3354, "text": "was exploiting"}, "argument": [{"index": "T39", "external_reference": {"wikidataid": "Q2798820"}, "endOffset": 3339, "role": {"type": "Discoverer"}, "text": "hacker", "startOffset": 3333, "type": "Person"}, {"index": "T32", "text": "the bug", "endOffset": 3362, "role": {"type": "Vulnerability"}, "startOffset": 3355, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 266, "index": "T34", "endOffset": 279, "text": "was exploited"}, "argument": [{"index": "T35", "text": "the vulnerability", "endOffset": 224, "role": {"type": "Vulnerability"}, "startOffset": 207, "type": "Vulnerability"}, {"index": "T1", "text": "leaked customer data from memory", "endOffset": 264, "role": {"CAPEC-Meta": "Resource Leak Exposure", "type": "Capabilities", "confidence": 0.9202393293380737}, "startOffset": 232, "type": "Capabilities"}, {"index": "T2", "text": "attackers", "endOffset": 292, "role": {"type": "Discoverer"}, "startOffset": 283, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 414, "index": "T3", "endOffset": 426, "text": "be exploited"}, "argument": [{"index": "T4", "text": "bug", "endOffset": 301, "role": {"type": "Vulnerability"}, "startOffset": 298, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1010, "index": "T14", "endOffset": 1019, "text": "disclosed"}, "argument": [{"index": "T15", "text": "Feb 17", "endOffset": 1026, "role": {"type": "Time"}, "startOffset": 1020, "type": "Time"}, {"index": "T13", "text": "The vulnerability", "endOffset": 995, "role": {"type": "Vulnerability"}, "startOffset": 978, "type": "Vulnerability"}, {"index": "T16", "text": "Google Project Zero researcher Tavis Ormandy", "endOffset": 1074, "role": {"type": "Discoverer"}, "startOffset": 1030, "type": "Person"}], "subtype": "DiscoverVulnerability"}]}, {"index": 3, "events": [{"index": "E2", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 808, "index": "T6", "endOffset": 813, "text": "leaks"}, "argument": [{"index": "T5", "text": "internal Cloudflare headers", "endOffset": 855, "role": {"type": "Compromised-Data"}, "startOffset": 828, "type": "Data"}, {"index": "T7", "text": "customer cookies", "endOffset": 876, "role": {"type": "Compromised-Data"}, "startOffset": 860, "type": "Data"}], "subtype": "Databreach"}]}, {"index": 4, "events": [{"index": "E11", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 181, "index": "T37", "endOffset": 185, "text": "said"}, "argument": [{"index": "T36", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Prince", "wikidataid": "Q2747456"}, "endOffset": 180, "role": {"type": "Discoverer"}, "text": "Prince", "startOffset": 174, "type": "Person"}, {"index": "T35", "text": "the vulnerability", "endOffset": 224, "role": {"type": "Vulnerability"}, "startOffset": 207, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "Cloudbleed Triggered 1.2M Times, Damage Kept to Minimum | Threatpost | The first stop for security news", "date": "2017_03_03", "type": "text", "link": "https://threatpost.com/cloudbleed-triggered-1-2m-times-damage-kept-to-minimum/124023/"}}