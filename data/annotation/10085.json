{"content": "For more than a month, at least ten groups of attackers have been compromising systems running applications built with Apache Struts and installing backdoors, DDoS bots, cryptocurrency miners, or ransomware, depending if the machine is running Linux or Windows. For their attacks, the groups are using a zero-day in Apache Struts, disclosed and immediately fixed last month by Apache. The vulnerability, CVE-2017-5638, allows an attacker to execute commands on the server via content uploaded to the Jakarta Multipart parser component, deployed in some Struts installations. Attackers initially focused on Linux server. According to cyber-security firms F5, attacks started as soon as Cisco Talos researchers revealed the zero-day's presence and several proof-of-concept exploits were published online. Since early March, attacks have slowly evolved. F5 experts say that in the beginning, attackers targeted Struts instances running on Linux servers, where they would end up installing the PowerBot malware, an IRC-controlled DDoS bot also known as PerlBot or Shellbot. In later attacks, some groups switched to installing a cryptocurrency miner called \"minerd\" that mined for the Monero cryptocurrency. In other attacks reported by the SANS Technology Institute, some attackers installed Perl backdoors. Recent attacks also targeted Struts running on Windows Both SANS and F5 experts report that after March 20, one of these groups switched to targeting Struts instances installed on Windows systems. Using a slightly modified exploit code, attackers executed various shell commands to run the BITSAdmin utility and then downloaded (via Windows' built-in FTP support) the Cerber ransomware. From this point on, Cerber took over, encrypted files, and displayed its standard ransom note, leaving victims no choice but pay the ransom demand or recover data from backups. \"The attackers running this [Cerber] campaign are using the same Bitcoin ID for a number of campaigns,\" the F5 team said. \"This particular account has processed 84 bitcoins [~$100,000].\" F5 experts also noted that, on average, roughly 2.2 Bitcoin (~$2,600) go in and out of this particular wallet on a daily basis. The most recent payments dates to today. It is worth mentioning that F5 published their findings last week, on March 29. Today, SANS detailed similar findings, meaning the campaign spreading Cerber ransomware via Struts on Windows is still going strong. A patch for Apache Struts servers is available on the Struts website. Struts is an open source MVC framework for creating modern Java web applications, and its widely used in enterprise environments, for both Intranets and public websites. Some of the initial attacks on Struts-based applications have been tracked by cyber-security firm AlienVault.", "sourcefile": "10085.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 709, "index": "T11", "endOffset": 717, "text": "revealed"}, "argument": [{"index": "T12", "text": "zero-day", "endOffset": 730, "role": {"type": "Vulnerability"}, "startOffset": 722, "type": "Vulnerability"}, {"index": "T10", "text": "Cisco Talos researchers", "endOffset": 708, "role": {"type": "Discoverer"}, "startOffset": 685, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 780, "index": "T14", "endOffset": 794, "text": "were published"}, "argument": [{"index": "T13", "text": "proof-of-concept exploits", "endOffset": 779, "role": {"type": "Vulnerability"}, "startOffset": 754, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2472, "index": "T20", "endOffset": 2484, "text": "is available"}, "argument": [{"index": "T22", "text": "A patch", "endOffset": 2445, "role": {"type": "Patch"}, "startOffset": 2438, "type": "Patch"}, {"index": "T21", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apache_Struts_2"}, "endOffset": 2471, "role": {"type": "Vulnerable_System"}, "text": "Apache Struts servers", "startOffset": 2450, "type": "System"}, {"index": "T23", "text": "the Struts website", "endOffset": 2506, "role": {"type": "Supported_Platform"}, "startOffset": 2488, "type": "Website"}], "subtype": "PatchVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 357, "index": "T2", "endOffset": 362, "text": "fixed"}, "argument": [{"index": "T3", "text": "last month", "endOffset": 373, "role": {"type": "Time"}, "startOffset": 363, "type": "Time"}, {"index": "T4", "external_reference": {"wikidataid": "Q3287188"}, "endOffset": 383, "role": {"type": "Releaser"}, "text": "Apache", "startOffset": 377, "type": "Organization"}, {"index": "T9", "text": "allows an attacker to execute commands on the server", "endOffset": 471, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Issues-Addressed", "confidence": 0.9195682406425476}, "startOffset": 419, "type": "Capabilities"}, {"index": "T8", "text": "CVE-2017-5638", "endOffset": 417, "role": {"type": "CVE"}, "startOffset": 404, "type": "CVE"}, {"index": "T7", "text": "The vulnerability", "endOffset": 402, "role": {"type": "Vulnerability"}, "startOffset": 385, "type": "Vulnerability"}, {"index": "T24", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apache_Struts_2"}, "endOffset": 573, "role": {"type": "Supported_Platform"}, "text": "some Struts installations", "startOffset": 548, "type": "System"}], "subtype": "PatchVulnerability"}]}, {"index": 2, "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 331, "index": "T1", "endOffset": 340, "text": "disclosed"}, "argument": [{"index": "T6", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apache_Struts_2"}, "endOffset": 329, "role": {"type": "Vulnerable_System"}, "text": "Apache Struts", "startOffset": 316, "type": "System"}, {"index": "T5", "text": "a zero-day", "endOffset": 312, "role": {"type": "Vulnerability"}, "startOffset": 302, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 3, "events": [{"index": "E5", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 1817, "index": "T19", "endOffset": 1838, "text": "pay the ransom demand"}, "argument": [{"index": "T17", "text": "displayed its standard ransom note", "endOffset": 1785, "role": {"CAPEC-Meta": "Flooding", "type": "Attack-Pattern", "confidence": 0.874845415353775}, "startOffset": 1751, "type": "Capabilities"}, {"index": "T16", "text": "encrypted files", "endOffset": 1745, "role": {"CAPEC-Meta": "File Manipulation", "type": "Attack-Pattern", "confidence": 0.8827282786369324}, "startOffset": 1730, "type": "Capabilities"}, {"index": "T15", "text": "took over", "endOffset": 1728, "role": {"CAPEC-Meta": "Malicious Logic Insertion", "type": "Attack-Pattern", "confidence": 0.9057292640209198}, "startOffset": 1719, "type": "Capabilities"}, {"index": "T18", "text": "victims", "endOffset": 1802, "role": {"type": "Victim"}, "startOffset": 1795, "type": "Person"}, {"index": "T25", "text": "Cerber", "endOffset": 1718, "role": {"type": "Tool"}, "startOffset": 1712, "type": "Malware"}], "subtype": "Ransom"}]}]}, "info": {"title": "Ransomware Gang Made Over $100,000 by Exploiting Apache Struts Zero-Day", "date": "2017_04_06", "type": "text", "link": "https://www.bleepingcomputer.com/news/security/ransomware-gang-made-over-100-000-by-exploiting-apache-struts-zero-day/"}}