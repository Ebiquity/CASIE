{"content": "The saga of CVE-2017-0199, a recently patched zero-day vulnerability affecting Microsoft Office and WordPad, just got a little stranger yesterday after cyber-security firm FireEye revealed the vulnerability was used by both cyber-criminals pushing mundane malware, and also by state-sponsored cyber-espionage groups. This twisted tale starts in July 2016, when security researcher Ryan Hanson discovered a flaw in RTF files that he could exploit to execute code on the underlying operating system. After finishing his research, Hanson submitted a write-up on the three bugs he found to Microsoft in October 2016, via the company's bug bounty program. Uncharacteristic to Microsoft, the company took almost six months to fix the three bugs discovered by Hanson, delivering patches for all three (CVE-2017-0106, CVE-2017-0199, and CVE-2017-0204) in April's Patch Tuesday. A few days before Microsoft patched the zero-day, news about it broke via blog posts from McAfee and FireEye, both companies revealing the zero-day was under active exploitation. Unfortunately, this long patching period gave others the time to discover the same flaw. While initially McAfee and FireEye restrained from revealing any details about the zero-day, now that a patch is available, several security firms are now sharing more behind-the-scenes details. According to FireEye, the zero-day first came on their radar on January 25, 2017, when they discovered a FinSpy module exploiting the flaw. While FireEye discovered only this campaign, the cyber-security firm believes Gamma Group made available this new Microsoft zero-day to all of its clients, meaning it was likely used in other countries where the company sold its \"lawful intercept\" spyware. Two months after this campaign, towards the end of March, FireEye says it detected the zero-day again, but this time used by a group of cyber-criminals spreading LatentBot, a sophisticated backdoor trojan, usually found in enterprise environments and used for economic espionage campaigns. This group apparently started a yard sale after McAfee and FireEye disclosed the zero-day in public. Fearing that a patch was coming, this group shared (most likely sold) the zero-day exploit with other crimeware groups. While initially this zero-day was classified as an Office vulnerability, Microsoft's security advisory revealed this vulnerability also affected WordPad, a free document viewer included by default with all Windows versions. This means that if users didn't have Office installed, they were at risk if they chose to open the booby-trapped files with WordPad. In this case, the exploit packed within the file would execute, download an HTA (HTML application) file disguised as an RTF, which in turn would run PowerShell commands that exploited the user's computer.", "sourcefile": "1656.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 720, "index": "T24", "endOffset": 723, "text": "fix"}, "argument": [{"index": "T23", "text": "the company", "endOffset": 693, "role": {"type": "Releaser"}, "startOffset": 682, "type": "Organization"}, {"index": "T35", "text": "six months", "endOffset": 716, "role": {"type": "Time"}, "startOffset": 706, "type": "Time"}], "subtype": "PatchVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 761, "index": "T28", "endOffset": 771, "text": "delivering"}, "argument": [{"index": "T29", "text": "patches", "endOffset": 779, "role": {"type": "Patch"}, "startOffset": 772, "type": "Patch"}, {"index": "T30", "text": "CVE-2017-0106", "endOffset": 808, "role": {"type": "CVE"}, "startOffset": 795, "type": "CVE"}, {"index": "T31", "text": "CVE-2017-0199", "endOffset": 823, "role": {"type": "CVE"}, "startOffset": 810, "type": "CVE"}, {"index": "T32", "text": "CVE-2017-0204", "endOffset": 842, "role": {"type": "CVE"}, "startOffset": 829, "type": "CVE"}, {"index": "T22", "text": "April", "endOffset": 852, "role": {"type": "Time"}, "startOffset": 847, "type": "Time"}], "subtype": "PatchVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 898, "index": "T36", "endOffset": 905, "text": "patched"}, "argument": [{"index": "T38", "text": "the zero-day", "endOffset": 918, "role": {"type": "Vulnerability"}, "startOffset": 906, "type": "Vulnerability"}, {"index": "T37", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 897, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 888, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"index": "E13", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1248, "index": "T49", "endOffset": 1260, "text": "is available"}, "argument": [{"index": "T50", "text": "a patch", "endOffset": 1247, "role": {"type": "Patch"}, "startOffset": 1240, "type": "Patch"}, {"index": "T51", "text": "now", "endOffset": 1234, "role": {"type": "Time"}, "startOffset": 1231, "type": "Time"}], "subtype": "PatchVulnerability"}, {"index": "E17", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2142, "index": "T66", "endOffset": 2152, "text": "was coming"}, "argument": [{"index": "T65", "text": "a patch", "endOffset": 2141, "role": {"type": "Patch"}, "startOffset": 2134, "type": "Patch"}], "subtype": "PatchVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E15", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1804, "index": "T58", "endOffset": 1812, "text": "detected"}, "argument": [{"index": "T59", "text": "the zero-day", "endOffset": 1825, "role": {"type": "Vulnerability"}, "startOffset": 1813, "type": "Vulnerability"}, {"index": "T60", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/FireEye", "wikidataid": "Q5451274"}, "endOffset": 1795, "role": {"type": "Discoverer"}, "text": "FireEye", "startOffset": 1788, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E22", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1944, "index": "T34", "endOffset": 1949, "text": "found"}, "argument": [{"index": "T78", "text": "a sophisticated backdoor trojan", "endOffset": 1934, "role": {"type": "Vulnerability"}, "startOffset": 1903, "type": "Vulnerability"}, {"index": "T33", "text": "used for economic espionage campaigns", "endOffset": 2018, "role": {"CAPEC-Meta": "Excavation", "type": "Capabilities", "confidence": 0.9288960695266724}, "startOffset": 1981, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 535, "index": "T15", "endOffset": 555, "text": "submitted a write-up"}, "argument": [{"index": "T16", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Tommy_Hanson", "wikidataid": "Q1058208"}, "endOffset": 534, "role": {"type": "Discoverer"}, "text": "Hanson", "startOffset": 528, "type": "Person"}, {"index": "T17", "text": "the three bugs", "endOffset": 573, "role": {"type": "Vulnerability"}, "startOffset": 559, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 577, "index": "T19", "endOffset": 582, "text": "found"}, "argument": [{"index": "T21", "text": "October 2016", "endOffset": 611, "role": {"type": "Time"}, "startOffset": 599, "type": "Time"}, {"index": "T18", "text": "he", "endOffset": 576, "role": {"type": "Discoverer"}, "startOffset": 574, "type": "Person"}, {"index": "T20", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 595, "role": {"type": "Vulnerable_System_Owner"}, "text": "Microsoft", "startOffset": 586, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 69, "index": "T3", "endOffset": 78, "text": "affecting"}, "argument": [{"index": "T4", "external_reference": {"wikidataid": "Q11255"}, "endOffset": 95, "role": {"type": "Vulnerable_System"}, "text": "Microsoft Office", "startOffset": 79, "type": "Software"}, {"index": "T5", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/WordPad"}, "endOffset": 107, "role": {"type": "Vulnerable_System"}, "text": "WordPad", "startOffset": 100, "type": "System"}, {"index": "T2", "text": "a recently patched zero-day vulnerability", "endOffset": 68, "role": {"type": "Vulnerability"}, "startOffset": 27, "type": "Vulnerability"}, {"index": "T1", "text": "CVE-2017-0199", "endOffset": 25, "role": {"type": "CVE"}, "startOffset": 12, "type": "CVE"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 180, "index": "T6", "endOffset": 188, "text": "revealed"}, "argument": [{"index": "T9", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/FireEye", "wikidataid": "Q5451274"}, "endOffset": 179, "role": {"type": "Discoverer"}, "text": "FireEye", "startOffset": 172, "type": "Organization"}, {"index": "T7", "text": "the vulnerability", "endOffset": 206, "role": {"type": "Vulnerability"}, "startOffset": 189, "type": "Vulnerability"}, {"index": "T8", "text": "pushing mundane malware", "endOffset": 263, "role": {"CAPEC-Meta": "Excavation", "type": "Capabilities", "confidence": 0.9173652529716492}, "startOffset": 240, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 393, "index": "T10", "endOffset": 403, "text": "discovered"}, "argument": [{"index": "T11", "text": "a flaw", "endOffset": 410, "role": {"type": "Vulnerability"}, "startOffset": 404, "type": "Vulnerability"}, {"index": "T12", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Tommy_Hanson", "wikidataid": "Q1058208"}, "endOffset": 392, "role": {"type": "Discoverer"}, "text": "security researcher Ryan Hanson", "startOffset": 361, "type": "Person"}, {"index": "T13", "text": "July 2016", "endOffset": 354, "role": {"type": "Time"}, "startOffset": 345, "type": "Time"}, {"index": "T14", "text": "exploit to execute code on the underlying operating system", "endOffset": 496, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9486298263072968}, "startOffset": 438, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 739, "index": "T26", "endOffset": 749, "text": "discovered"}, "argument": [{"index": "T25", "text": "the three bugs", "endOffset": 738, "role": {"type": "Vulnerability"}, "startOffset": 724, "type": "Vulnerability"}, {"index": "T27", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Tommy_Hanson", "wikidataid": "Q1058208"}, "endOffset": 759, "role": {"type": "Discoverer"}, "text": "Hanson", "startOffset": 753, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 995, "index": "T39", "endOffset": 1004, "text": "revealing"}, "argument": [{"index": "T41", "text": "the zero-day", "endOffset": 1017, "role": {"type": "Vulnerability"}, "startOffset": 1005, "type": "Vulnerability"}, {"index": "T40", "text": "both companies", "endOffset": 994, "role": {"type": "Discoverer"}, "startOffset": 980, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1114, "index": "T43", "endOffset": 1122, "text": "discover"}, "argument": [{"index": "T44", "text": "the same flaw", "endOffset": 1136, "role": {"type": "Vulnerability"}, "startOffset": 1123, "type": "Vulnerability"}, {"index": "T42", "external_reference": {"wikidataid": "Q7108666"}, "endOffset": 1101, "role": {"type": "Discoverer"}, "text": "others", "startOffset": 1095, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1189, "index": "T47", "endOffset": 1198, "text": "revealing"}, "argument": [{"index": "T48", "text": "the zero-day", "endOffset": 1229, "role": {"type": "Vulnerability"}, "startOffset": 1217, "type": "Vulnerability"}, {"index": "T46", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/FireEye", "wikidataid": "Q5451274"}, "endOffset": 1172, "role": {"type": "Discoverer"}, "text": "FireEye", "startOffset": 1165, "type": "Organization"}, {"index": "T45", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Intel_Security", "wikidataid": "Q267313"}, "endOffset": 1160, "role": {"type": "Discoverer"}, "text": "McAfee", "startOffset": 1154, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E14", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1425, "index": "T53", "endOffset": 1435, "text": "discovered"}, "argument": [{"index": "T54", "text": "the flaw", "endOffset": 1471, "role": {"type": "Vulnerability"}, "startOffset": 1463, "type": "Vulnerability"}, {"index": "T52", "text": "they", "endOffset": 1424, "role": {"type": "Discoverer"}, "startOffset": 1420, "type": "Organization"}, {"index": "T55", "text": "the zero-day", "endOffset": 1367, "role": {"type": "Vulnerability"}, "startOffset": 1355, "type": "Vulnerability"}, {"index": "T56", "text": "January 25, 2017", "endOffset": 1413, "role": {"type": "Time"}, "startOffset": 1397, "type": "Time"}, {"index": "T57", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/FireEye", "wikidataid": "Q5451274"}, "endOffset": 1353, "role": {"type": "Discoverer"}, "text": "FireEye", "startOffset": 1346, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E16", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2087, "index": "T63", "endOffset": 2096, "text": "disclosed"}, "argument": [{"index": "T64", "text": "the zero-day", "endOffset": 2109, "role": {"type": "Vulnerability"}, "startOffset": 2097, "type": "Vulnerability"}, {"index": "T62", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/FireEye", "wikidataid": "Q5451274"}, "endOffset": 2086, "role": {"type": "Discoverer"}, "text": "FireEye", "startOffset": 2079, "type": "Organization"}, {"index": "T61", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Intel_Security", "wikidataid": "Q267313"}, "endOffset": 2074, "role": {"type": "Discoverer"}, "text": "McAfee", "startOffset": 2068, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E18", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2165, "index": "T67", "endOffset": 2171, "text": "shared"}, "argument": [{"index": "T69", "text": "the zero-day exploit", "endOffset": 2211, "role": {"type": "Vulnerability"}, "startOffset": 2191, "type": "Vulnerability"}, {"index": "T68", "text": "this group", "endOffset": 2164, "role": {"type": "Discoverer"}, "startOffset": 2154, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E19", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2271, "index": "T70", "endOffset": 2285, "text": "was classified"}, "argument": [{"index": "T72", "text": "this zero-day", "endOffset": 2270, "role": {"type": "Vulnerability"}, "startOffset": 2257, "type": "Vulnerability"}, {"index": "T71", "text": "an Office vulnerability", "endOffset": 2312, "role": {"type": "Vulnerability"}, "startOffset": 2289, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E20", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2344, "index": "T74", "endOffset": 2352, "text": "revealed"}, "argument": [{"index": "T75", "text": "this vulnerability", "endOffset": 2371, "role": {"type": "Vulnerability"}, "startOffset": 2353, "type": "Vulnerability"}, {"index": "T73", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 2343, "role": {"type": "Discoverer"}, "text": "Microsoft's security advisory", "startOffset": 2314, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E21", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2377, "index": "T76", "endOffset": 2385, "text": "affected"}, "argument": [{"index": "T77", "external_reference": {"wikidataid": "Q29482"}, "endOffset": 2393, "role": {"type": "Vulnerable_System"}, "text": "WordPad", "startOffset": 2386, "type": "Software"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "Recent Microsoft 0-Day Used for Cyber-Espionage and Mundane Malware Distribution", "date": "2017_04_14", "type": "text", "link": "https://www.bleepingcomputer.com/news/security/recent-microsoft-0-day-used-for-cyber-espionage-and-mundane-malware-distribution/"}}