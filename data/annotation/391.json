{"content": "Freelance security researcher Dan Melamed has done us all a solid. Then, he did the right thing: he reported it to Facebook. Melamed said in a blog post on Monday that he\u2019d discovered the critical vulnerability in June. Besides finding a kill switch for any public video, he also discovered he could disable commenting on any video. Melamed had looked at the HTTP request that his browser sends to Facebook when he uploads a video. Using a program called Fiddler, he intercepted the request, swapped out his video\u2019s ID for one belonging to a victim\u2019s video, and then sent the modified request on its way to Facebook. Melamed\u2019s method is simple: first, an attacker would either create a public event on Facebook or visit any existing public event. Then, they\u2019d go to the event\u2019s Discussion tab and create an event post by uploading a photo or video. He found that when you swap the value of the composer_unpublished_photo[0] parameter for the ID of the Facebook video you want to kill, the server will balk, putting out this error message: This content is no longer available. Error message or no error message, the video will still successfully attach itself to the created event post. When an attacker refreshes the Events Discussion page, they\u2019d see that the event posting had appeared with the victim\u2019s video attached. Then, it\u2019s just a matter of clicking a small arrow dropdown and choosing \u201cDelete Post\u201d. A dialog box will warn that the video will also be removed from Photos and Videos. If you confirm in the dialog box that yes, you want to delete the video, Poof! Credit where credit\u2019s due, Melamed noted that this vulnerability is similar to another video deletion bug that Indian security researcher and penetration tester Pranav Hivarekar discovered, also in June 2016. In a nutshell: whereas Hivarekar\u2019s flaw had to do with attaching a victim\u2019s video to a comment, Melamed discovered a way to attach the video to an event post. Delete the bath water/event post, and that baby/video gets tossed right out with it. This one had to do with how one man could have deleted any Facebook photo album that he could see. Mark offers this digression: In Melamed\u2019s attack on videos, he specifies the ID of a video he\u2019s targeting specifically, but since video IDs are just numbers, he could have just guessed one and wiped out a video at random.", "sourcefile": "391.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1607, "index": "T14", "endOffset": 1612, "text": "noted"}, "argument": [{"index": "T15", "text": "this vulnerability", "endOffset": 1636, "role": {"type": "Vulnerability"}, "startOffset": 1618, "type": "Vulnerability"}, {"index": "T16", "external_reference": {"wikidataid": "Q67215308"}, "endOffset": 1606, "role": {"type": "Discoverer"}, "text": "Melamed", "startOffset": 1599, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1750, "index": "T17", "endOffset": 1760, "text": "discovered"}, "argument": [{"index": "T18", "text": "Pranav Hivarekar", "endOffset": 1749, "role": {"type": "Discoverer"}, "startOffset": 1733, "type": "Person"}, {"index": "T19", "text": "June 2016", "endOffset": 1779, "role": {"type": "Time"}, "startOffset": 1770, "type": "Time"}, {"index": "T20", "text": "another video deletion bug", "endOffset": 1677, "role": {"type": "Vulnerability"}, "startOffset": 1651, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1885, "index": "T23", "endOffset": 1895, "text": "discovered"}, "argument": [{"index": "T25", "text": "attach the video to an event post", "endOffset": 1938, "role": {"CAPEC-Meta": "Content Spoofing", "type": "Capabilities", "confidence": 0.857077956199646}, "startOffset": 1905, "type": "Capabilities"}, {"index": "T24", "external_reference": {"wikidataid": "Q67215308"}, "endOffset": 1884, "role": {"type": "Discoverer"}, "text": "Melamed", "startOffset": 1877, "type": "Person"}, {"index": "T22", "text": "Hivarekar\u2019s flaw", "endOffset": 1820, "role": {"type": "Vulnerability"}, "startOffset": 1804, "type": "Vulnerability"}, {"index": "T21", "text": "attaching a victim\u2019s video to a comment", "endOffset": 1875, "role": {"CAPEC-Meta": "Buffer Manipulation", "type": "Capabilities", "confidence": 0.8782118558883667}, "startOffset": 1836, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 173, "index": "T1", "endOffset": 183, "text": "discovered"}, "argument": [{"index": "T4", "external_reference": {"wikidataid": "Q67215308"}, "endOffset": 132, "role": {"type": "Discoverer"}, "text": "Melamed", "startOffset": 125, "type": "Person"}, {"index": "T5", "text": "Monday", "endOffset": 162, "role": {"type": "Time"}, "startOffset": 156, "type": "Time"}, {"index": "T2", "text": "the critical vulnerability", "endOffset": 210, "role": {"type": "Vulnerability"}, "startOffset": 184, "type": "Vulnerability"}, {"index": "T3", "text": "June", "endOffset": 218, "role": {"type": "Time"}, "startOffset": 214, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 228, "index": "T6", "endOffset": 235, "text": "finding"}, "argument": [{"index": "T7", "text": "a kill switch", "endOffset": 249, "role": {"type": "Vulnerability"}, "startOffset": 236, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 280, "index": "T8", "endOffset": 290, "text": "discovered"}, "argument": [{"index": "T9", "text": "he", "endOffset": 274, "role": {"type": "Discoverer"}, "startOffset": 272, "type": "Person"}, {"index": "T10", "text": "he", "endOffset": 293, "role": {"type": "Discoverer"}, "startOffset": 291, "type": "Person"}, {"index": "T11", "text": "disable commenting on any video", "endOffset": 331, "role": {"CAPEC-Meta": "Content Spoofing", "type": "Capabilities", "confidence": 0.8720394372940063}, "startOffset": 300, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "How one man could have deleted any public Facebook video \u2013 Naked Security", "date": "2017_01_27", "type": "text", "link": "https://nakedsecurity.sophos.com/2017/01/26/how-one-man-could-have-deleted-any-public-facebook-video/?utm_source=Naked+Security+-+Sophos+List&utm_campaign=5b01698c7d-naked%252Bsecurity&utm_medium=email&utm_term=0_31623bb782-5b01698c7d-455160889"}}