{"content": "A bloke has told how he discovered a bug in Valve's Steam marketplace that could have been exploited by thieves to steal game license keys and play pirated titles. Researcher Artem Moskowsky told The Register earlier this week that he stumbled across the vulnerability \u2013 which earned him a $20,000 bug bounty for reporting it \u2013 by accident while looking over the Steam partner portal. That's the site developers use to manage the games they make available for download from Steam. A professional bug-hunter and pentester, Moskowsky said he has been doing security research since he was in school, and for the past several years, he has made a career out of finding and reporting flaws. In this case, while looking through the Steam developer site, he noticed it was fairly easy to change parameters in an API request, and get activation keys for a selected game in return. Those keys, also known as CD keys, can be used to activate and play games downloaded from Steam. The API is provided so developers and their partners can obtain license keys for their titles to pass onto gamers. \"This bug was discovered randomly during the exploration of the functionality of a web application,\" Moskowsky explained. \"It could have been used by any attacker who had access to the portal.\" Essentially, anyone who had an account on the developer portal would be able to access the game activation keys for any other game Steam hosted, and sell or distribute them for pirates to use to play games from Steam. Fetching from the /partnercdkeys/assignkeys/ API with a zero key count returned a huge bunch of activation keys. \"To exploit the vulnerability, it was necessary to make only one request,\" Moskowsky told El Reg. \"I managed to bypass the verification of ownership of the game by changing only one parameter. After that, I could enter any ID into another parameter and get any set of keys.\" How severe was the flaw? Moskowski says that, in one case, he entered a random string into the request, to pick a title at random, and in return he got 36,000 activation keys for Portal 2, a game that still retails for $9.99 in the Steam store. Fortunately for Valve, Moskowsky opted to privately come forward with the flaw via HackerOne. The programming blunder has since been fixed. As the HackerOne entry for the vulnerability shows, Moskowsky first submitted the report on the flaw in early August. Three days later, Valve handed out the $15,000 bounty as well as a $5,000 bonus for the find, though Valve only allowed the report to go public on October 31. The researcher told us this is a pretty good turnaround, and Valve in particular is very good with handling researcher requests and paying out bug bounties. Impressively, this $20,000 bounty isn't even the biggest payout Moskowsky has received from the games service. Back in July he was given a cool $25,000 for weeding out a SQL Injection bug in the same developer portal. ", "sourcefile": "10282.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1196, "index": "T21", "endOffset": 1205, "text": "explained"}, "argument": [{"index": "T20", "text": "Moskowsky", "endOffset": 1195, "role": {"type": "Discoverer"}, "startOffset": 1186, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1095, "index": "T18", "endOffset": 1109, "text": "was discovered"}, "argument": [{"index": "T19", "text": "This bug", "endOffset": 1094, "role": {"type": "Vulnerability"}, "startOffset": 1086, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E10", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 86, "index": "T32", "endOffset": 100, "text": "been exploited"}, "argument": [{"index": "T5", "text": "steal game license keys and play pirated title", "endOffset": 161, "role": {"CAPEC-Meta": "Content Spoofing", "type": "Capabilities", "confidence": 0.8800072073936462}, "startOffset": 115, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 24, "index": "T2", "endOffset": 34, "text": "discovered"}, "argument": [{"index": "T4", "external_reference": {"wikidataid": "Q337535"}, "endOffset": 69, "role": {"type": "Vulnerable_System"}, "text": "Steam marketplace", "startOffset": 52, "type": "System"}, {"index": "T3", "text": "a bug", "endOffset": 40, "role": {"type": "Vulnerability"}, "startOffset": 35, "type": "Vulnerability"}, {"index": "T1", "text": "he", "endOffset": 23, "role": {"type": "Discoverer"}, "startOffset": 21, "type": "Person"}, {"index": "T6", "text": "A bloke", "endOffset": 7, "role": {"type": "Discoverer"}, "startOffset": 0, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 235, "index": "T10", "endOffset": 243, "text": "stumbled"}, "argument": [{"index": "T7", "text": "Researcher Artem Moskowsky", "endOffset": 190, "role": {"type": "Discoverer"}, "startOffset": 164, "type": "Person"}, {"index": "T8", "text": "earlier this week", "endOffset": 226, "role": {"type": "Time"}, "startOffset": 209, "type": "Time"}, {"index": "T9", "text": "he", "endOffset": 234, "role": {"type": "Discoverer"}, "startOffset": 232, "type": "Person"}, {"index": "T11", "text": "the vulnerability", "endOffset": 268, "role": {"type": "Vulnerability"}, "startOffset": 251, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 313, "index": "T12", "endOffset": 322, "text": "reporting"}, "argument": [{"index": "T13", "text": "it", "endOffset": 325, "role": {"type": "Vulnerability"}, "startOffset": 323, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "events": [{"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2338, "index": "T27", "endOffset": 2358, "text": "submitted the report"}, "argument": [{"index": "T26", "text": "Moskowsky", "endOffset": 2331, "role": {"type": "Discoverer"}, "startOffset": 2322, "type": "Person"}, {"index": "T24", "text": "the flaw", "endOffset": 2370, "role": {"type": "Vulnerability"}, "startOffset": 2362, "type": "Vulnerability"}, {"index": "T25", "text": "early August", "endOffset": 2386, "role": {"type": "Time"}, "startOffset": 2374, "type": "Time"}], "subtype": "DiscoverVulnerability"}]}, {"index": 3, "events": [{"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2860, "index": "T28", "endOffset": 2871, "text": "weeding out"}, "argument": [{"index": "T31", "text": "he", "endOffset": 2830, "role": {"type": "Discoverer"}, "startOffset": 2828, "type": "Person"}, {"index": "T30", "text": "July", "endOffset": 2827, "role": {"type": "Time"}, "startOffset": 2823, "type": "Time"}, {"index": "T29", "text": "a SQL Injection bug", "endOffset": 2891, "role": {"type": "Vulnerability"}, "startOffset": 2872, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 4, "events": [{"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2248, "index": "T22", "endOffset": 2268, "text": "has since been fixed"}, "argument": [{"index": "T23", "text": "The programming blunder", "endOffset": 2247, "role": {"type": "Vulnerable_System"}, "startOffset": 2224, "type": "Software"}], "subtype": "PatchVulnerability"}]}, {"index": 5, "events": [{"index": "E4", "type": "Vulnerability-related", "realis": "Generic", "nugget": {"startOffset": 657, "index": "T14", "endOffset": 678, "text": "finding and reporting"}, "argument": [{"index": "T15", "text": "flaws", "endOffset": 684, "role": {"type": "Vulnerability"}, "startOffset": 679, "type": "Vulnerability"}, {"index": "T16", "text": "he", "endOffset": 631, "role": {"type": "Discoverer"}, "startOffset": 629, "type": "Person"}, {"index": "T17", "text": "Moskowsky", "endOffset": 531, "role": {"type": "Discoverer"}, "startOffset": 522, "type": "Person"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "I found a security hole in Steam that gave me every game's license keys and all I got was this... oh nice: $20,000", "date": "2018_11_09", "type": "text", "link": "https://www.theregister.co.uk/2018/11/09/valve_steam_key_vulnerability/"}}