{"content": "A zero-day vulnerability exists in WordPress Core that in some instances could allow an attacker to reset a user\u2019s password and gain access to their account. Researcher Dawid Golunski of Legal Hackers disclosed the vulnerability on Wednesday via his new ExploitBox service. All versions of WordPress, including the latest, 4.7.4, are vulnerable, the researcher said. The vulnerability (CVE-2017-8295) happens because WordPress uses what Golunski calls untrusted data by default when it creates a password reset email. In a proof-of-concept writeup, Golunski points out that WordPress uses a variable, SERVER_NAME, to get the hostname to create a From/Return-Path header for the password reset email. Since that variable, by its nature, can be customized, an attacker could insert a domain of his choosing and make it so an outgoing email could be sent to a malicious address, the researcher says. The attacker would then receive the reset email and be able to change the account password and take over. \u201cDepending on the configuration of the mail server, it may result in an email that gets sent to the victim WordPress user with such malicious From/Return-Path address set in the email headers,\u201d Golunski wrote. \u201cThis could possibly allow the attacker to intercept the email containing the password reset link in some cases requiring user interaction as well as without user interaction.\u201d Golunski writes that there are three scenarios in which a user could be tricked, and only one of them relies on user interaction. In one, an attacker could perform a denial of service attack on the victim\u2019s email account in order to prevent the password reset email from reaching the victim\u2019s account. Instead, it could bounce back to the malicious sender address, pointed at the attacker. Second, Golunski says some auto-responders may attach a copy of the email sent in the body of the auto-replied message. Third, by sending multiple password reset emails, he says the attacker could trigger the victim to ask for an explanation, below, which could contain the malicious password link. Golunski said he reported the issue to WordPress\u2019s security team multiple times, initially more than 10 months ago in July 2016. The researcher told Threatpost that WordPress never outright rejected his claim \u2013 he says WordPress told him it was working on the issue \u2013 but acknowledged that too much time has passed without a clear resolution, something which prompted him to release details on the bug on Wednesday. Campbell said that it\u2019s possible WordPress will patch the issue, even if just for poorly configured servers, but acknowledged he didn\u2019t have a timetable for the fix. Concerned WordPress users should follow a public ticket that was started for the issue last July, Campbell added. While there\u2019s no official fix available yet, Golunski says users can enable the UseCanonicalName setting on Apache to enforce a static SERVER_NAME value to ensure it doesn\u2019t get modified. Golunski has had his hands full finding vulnerabilities related to PHP-based email platforms. He discovered a remote code execution bug in SquirrelMail in January that disclosed and quickly patched last month and similar RCE bugs in PHPMailer and SwiftMailer, libraries used to send emails via PHP, at the end of 2016.", "sourcefile": "2101.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 25, "index": "T1", "endOffset": 34, "text": "exists in"}, "argument": [{"index": "T2", "text": "A zero-day vulnerability", "endOffset": 24, "role": {"type": "Vulnerability"}, "startOffset": 0, "type": "Vulnerability"}, {"index": "T3", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/WordPress"}, "endOffset": 44, "role": {"type": "Vulnerable_System"}, "text": "WordPress", "startOffset": 35, "type": "System"}, {"index": "T4", "text": "allow an attacker to reset a user\u2019s password", "endOffset": 123, "role": {"CAPEC-Meta": "Privilege Abuse", "type": "Capabilities", "confidence": 0.9010112285614014}, "startOffset": 79, "type": "Capabilities"}, {"index": "T5", "text": "gain access to their account", "endOffset": 156, "role": {"CAPEC-Meta": "Authentication Bypass", "type": "Capabilities", "confidence": 0.9118092060089111}, "startOffset": 128, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 201, "index": "T9", "endOffset": 210, "text": "disclosed"}, "argument": [{"index": "T8", "text": "vulnerability", "endOffset": 228, "role": {"type": "Vulnerability"}, "startOffset": 215, "type": "Vulnerability"}, {"index": "T10", "text": "Wednesday", "endOffset": 241, "role": {"type": "Time"}, "startOffset": 232, "type": "Time"}, {"index": "T7", "text": "Legal Hackers", "endOffset": 200, "role": {"type": "Discoverer"}, "startOffset": 187, "type": "Organization"}, {"index": "T6", "text": "Researcher Dawid Golunski", "endOffset": 183, "role": {"type": "Discoverer"}, "startOffset": 158, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 330, "index": "T12", "endOffset": 344, "text": "are vulnerable"}, "argument": [{"index": "T11", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/WordPress"}, "endOffset": 299, "role": {"type": "Vulnerable_System"}, "text": "WordPress", "startOffset": 290, "type": "System"}, {"index": "T13", "external_reference": {"wikidataid": "Q46240963"}, "endOffset": 360, "role": {"type": "Discoverer"}, "text": "researcher", "startOffset": 350, "type": "Person"}, {"index": "T14", "text": "CVE-2017-8295", "endOffset": 399, "role": {"type": "CVE"}, "startOffset": 386, "type": "CVE"}, {"index": "T15", "text": "vulnerability", "endOffset": 384, "role": {"type": "Vulnerability"}, "startOffset": 371, "type": "Vulnerability"}, {"index": "T17", "text": "Golunski", "endOffset": 445, "role": {"type": "Discoverer"}, "startOffset": 437, "type": "Person"}, {"index": "T16", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/WordPress"}, "endOffset": 426, "role": {"type": "Vulnerable_System"}, "text": "WordPress", "startOffset": 417, "type": "System"}, {"index": "T54", "text": "4.7.4", "endOffset": 328, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 323, "type": "Version"}], "subtype": "DiscoverVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2088, "index": "T22", "endOffset": 2092, "text": "said"}, "argument": [{"index": "T21", "text": "Golunski", "endOffset": 2087, "role": {"type": "Discoverer"}, "startOffset": 2079, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2096, "index": "T20", "endOffset": 2104, "text": "reported"}, "argument": [{"index": "T23", "text": "issue", "endOffset": 2114, "role": {"type": "Vulnerability"}, "startOffset": 2109, "type": "Vulnerability"}, {"index": "T24", "text": "security team", "endOffset": 2143, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 2130, "type": "Person"}, {"index": "T25", "text": "July 2016", "endOffset": 2206, "role": {"type": "Time"}, "startOffset": 2197, "type": "Time"}, {"index": "T26", "text": "10 months ago", "endOffset": 2193, "role": {"type": "Time"}, "startOffset": 2180, "type": "Time"}, {"index": "T53", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/WordPress"}, "endOffset": 2127, "role": {"type": "Vulnerable_System"}, "text": "WordPress", "startOffset": 2118, "type": "System"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2454, "index": "T27", "endOffset": 2469, "text": "release details"}, "argument": [{"index": "T28", "text": "bug", "endOffset": 2480, "role": {"type": "Vulnerability"}, "startOffset": 2477, "type": "Vulnerability"}, {"index": "T29", "text": "Wednesday", "endOffset": 2493, "role": {"type": "Time"}, "startOffset": 2484, "type": "Time"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E8", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 2543, "index": "T31", "endOffset": 2548, "text": "patch"}, "argument": [{"index": "T30", "external_reference": {"wikidataid": "Q13166"}, "endOffset": 2537, "role": {"type": "Vulnerable_System"}, "text": "WordPress", "startOffset": 2528, "type": "Software"}, {"index": "T32", "text": "issue", "endOffset": 2558, "role": {"type": "Vulnerability"}, "startOffset": 2553, "type": "Vulnerability"}, {"index": "T33", "text": "the fix", "endOffset": 2659, "role": {"type": "Patch"}, "startOffset": 2652, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 2805, "index": "T34", "endOffset": 2814, "text": "available"}, "argument": [{"index": "T35", "text": "fix", "endOffset": 2804, "role": {"type": "Patch"}, "startOffset": 2801, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E13", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3153, "index": "T46", "endOffset": 3160, "text": "patched"}, "argument": [{"index": "T47", "text": "last month", "endOffset": 3171, "role": {"type": "Time"}, "startOffset": 3161, "type": "Time"}, {"index": "T52", "text": "2016", "endOffset": 3280, "role": {"type": "Time"}, "startOffset": 3276, "type": "Time"}, {"index": "T51", "text": "PHP", "endOffset": 3260, "role": {"type": "Vulnerable_System"}, "startOffset": 3257, "type": "System"}, {"index": "T50", "text": "SwiftMailer", "endOffset": 3221, "role": {"type": "Vulnerable_System"}, "startOffset": 3210, "type": "System"}, {"index": "T49", "text": "PHPMailer", "endOffset": 3205, "role": {"type": "Vulnerable_System"}, "startOffset": 3196, "type": "System"}, {"index": "T48", "text": "RCE bugs", "endOffset": 3192, "role": {"type": "Vulnerability"}, "startOffset": 3184, "type": "Vulnerability"}, {"index": "T41", "text": "He", "endOffset": 3059, "role": {"type": "Releaser"}, "startOffset": 3057, "type": "Person"}], "subtype": "PatchVulnerability"}]}, {"index": 2, "relation": "Same", "events": [{"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2995, "index": "T36", "endOffset": 3002, "text": "finding"}, "argument": [{"index": "T38", "text": "Golunski", "endOffset": 2971, "role": {"type": "Discoverer"}, "startOffset": 2963, "type": "Person"}, {"index": "T37", "text": "vulnerabilities", "endOffset": 3018, "role": {"type": "Vulnerability"}, "startOffset": 3003, "type": "Vulnerability"}, {"index": "T39", "text": "PHP-based email platforms", "endOffset": 3055, "role": {"type": "Vulnerable_System"}, "startOffset": 3030, "type": "System"}], "subtype": "DiscoverVulnerability"}, {"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3060, "index": "T40", "endOffset": 3070, "text": "discovered"}, "argument": [{"index": "T41", "text": "He", "endOffset": 3059, "role": {"type": "Discoverer"}, "startOffset": 3057, "type": "Person"}, {"index": "T42", "text": "bug", "endOffset": 3098, "role": {"type": "Vulnerability"}, "startOffset": 3095, "type": "Vulnerability"}, {"index": "T43", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/SquirrelMail"}, "endOffset": 3114, "role": {"type": "Vulnerable_System"}, "text": "SquirrelMail", "startOffset": 3102, "type": "System"}, {"index": "T44", "text": "January", "endOffset": 3125, "role": {"type": "Time"}, "startOffset": 3118, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"nugget": {"startOffset": 3131, "index": "T45", "endOffset": 3140, "text": "disclosed"}, "index": "E12", "type": "Vulnerability-related", "subtype": "DiscoverVulnerability", "realis": "Actual"}]}, {"index": 3, "events": [{"index": "E4", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1459, "index": "T18", "endOffset": 1469, "text": "be tricked"}, "argument": [{"index": "T19", "external_reference": {"wikidataid": "Q20850624"}, "endOffset": 1452, "role": {"type": "Victim"}, "text": "user", "startOffset": 1448, "type": "Person"}], "subtype": "Phishing"}]}]}, "info": {"title": "Unpatched WordPress Password Reset Vulnerability Lingers | Threatpost | The first stop for security news", "date": "2017_05_05", "type": "text", "link": "https://threatpost.com/unpatched-wordpress-password-reset-vulnerability-lingers/125421/"}}