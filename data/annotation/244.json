{"content": "Details on serious vulnerabilities in a number of routers freely distributed by a major Thai ISP were published on Monday after private disclosures made to the vendors in July went unanswered. Researcher Pedro Ribeiro of Agile Information Security found accessible admin accounts and command injection vulnerabilities in ZyXel and Billion routers distributed by TrueOnline, Thailand\u2019s largest broadband company. Ribeiro said he disclosed the vulnerabilities through Beyond Security\u2019s SecuriTeam Secure Disclosure Program, which contacted the affected vendors last July. Ribeiro published a proof of concept exploit yesterday as well. Ribeiro told Threatpost he\u2019s unsure whether TrueOnline introduced the vulnerabilities as it adds its own customization to the routers, or whether they came from the respective manufacturers. A ZyXel representative told Threatpost\u00a0the router models are no longer supported and would not comment on whether patches were being developed. A request for comment from Billion was not returned in time for publication. The commonality between the routers appears to be that they\u2019re all based on the TC3162U system-on-a-chip manufactured by TrendChip. Affected routers are the ZyXel P660HN-T v1 and P660HN-T v2, and Billion 5200 W-T, currently in distribution to TrueOnline customers. The TC3162U chips run two different firmware variants, one called \u201cras\u201d which includes the Allegro RomPage webserver vulnerable to the Misfortne Cookie attacks, and the other called tclinux. The tclinux variant contains the vulnerabilities found by Ribeiro, in particular several ASP files, he said, are vulnerable to command injection attacks. He also cautions that they could be also vulnerable to Misfortune Cookie, but he did not investigate this possibility. \u201cIt should be noted that tclinux contains files and configuration settings in other languages (for example in Turkish). Therefore it is likely that these firmware versions are not specific to TrueOnline, and other ISP customised routers in other countries might also be vulnerable,\u201d Ribeiro said in his advisory. \u201cIt is also possible that other brands and router models that use the tclinux variant are also affected by the command injection vulnerabilities (the default accounts are likely to be TrueOnline specific)\u201d. In addition to Ribeiro\u2019s proof-of-concept, Metasploit modules are available for three of the vulnerabilities. Most of the vulnerabilities can be exploited remotely, some without authentication. \u201cThese vulnerabilities are present in the web interface. The default credentials are part of the firmware deployed by TrueOnline and they are authorized to perform remote access over the WAN,\u201d Ribeiro said. \u201cDue to time and lab constraints I was unable to test whether these routers expose the web interface over the WAN, but given the credentials, it is likely\u201d. The ZyXel P660HN-T v1 router is vulnerable to an unauthenticated command injection attack that can be exploited remotely. Ribeiro said he found the vulnerability in the remote system log forwarding function, specifically in the ViewLog.asp page. V2 of the same router contains the same vulnerability, but cannot be exploited without authentication, he said. \u201cUnlike in the P660HN-Tv1, the injection is authenticated and in the logSet.asp page. However, this router contains a hardcoded supervisor password that can be used to exploit this vulnerability,\u201d Ribeiro said. \u201cThe injection is in the logSet.asp page that sets up remote forwarding of syslog logs, and the parameter vulnerable to injection is the serverIP parameter\u201d. The Billion 5200W-T is also vulnerable to unauthenticated and authenticated command injection attacks; the vulnerability was found in its adv_remotelog.asp page. \u201cThe Billion 5200W-T router also has several other command injections in its interface, depending on the firmware version, such as an authenticated command injection in tools_time.asp (uiViewSNTPServer parameter),\u201d Ribeiro said. It should be noted that this router contains several hardcoded administrative accounts that can be used to exploit this vulnerability\u201d. Ribeiro said default and weak admin credentials were found on the all of the versions and were accessible remotely. The researcher said it\u2019s unknown whether the routers can be patched remotely. \u201cAgain, given the existence of default credentials that have remote access, it is likely that it is possible to update the firmware remotely,\u201d Ribeiro said. Most of iBall baton routers in India are also vulnerable to unauthenticated and authenticated command injection attack,i have reason to believe default and weak admin credentials are on the all of the versions and were accessible remotely. i Have I \u201cBall WRA150N\u201d ADSL2+ iBall baton Router.And IBall  is  never accepting not even taking response  to complains and request for latest firmware patches. ASUS patched a bug that allowed attackers to pair two vulnerabilities to gain direct router access and execute commands as root. Thanks to Meltdown and Spectre, January has already been an extremely busy month of patching for Microsoft.", "sourcefile": "244.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2983, "index": "T24", "endOffset": 2987, "text": "said"}, "argument": [{"index": "T43", "external_reference": {"wikidataid": "Q33690807"}, "endOffset": 2982, "role": {"type": "Discoverer"}, "text": "Ribeiro", "startOffset": 2975, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2991, "index": "T41", "endOffset": 2996, "text": "found"}, "argument": [{"index": "T42", "text": "the vulnerability", "endOffset": 3014, "role": {"type": "Vulnerability"}, "startOffset": 2997, "type": "Vulnerability"}, {"index": "T45", "text": "the remote system", "endOffset": 3035, "role": {"type": "Vulnerable_System"}, "startOffset": 3018, "type": "System"}, {"index": "T44", "text": "he", "endOffset": 2990, "role": {"type": "Discoverer"}, "startOffset": 2988, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1551, "index": "T27", "endOffset": 1556, "text": "found"}, "argument": [{"index": "T28", "text": "the vulnerabilities", "endOffset": 1550, "role": {"type": "Vulnerability"}, "startOffset": 1531, "type": "Vulnerability"}, {"index": "T32", "text": "The tclinux variant", "endOffset": 1521, "role": {"type": "Vulnerable_System"}, "startOffset": 1502, "type": "Software"}, {"index": "T29", "external_reference": {"wikidataid": "Q33690807"}, "endOffset": 1567, "role": {"type": "Discoverer"}, "text": "Ribeiro", "startOffset": 1560, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E16", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1605, "index": "T70", "endOffset": 1609, "text": "said"}, "argument": [{"index": "T30", "text": "command injection attacks", "endOffset": 1654, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9119876027107239}, "startOffset": 1629, "type": "Capabilities"}, {"index": "T31", "text": "he", "endOffset": 1604, "role": {"type": "Discoverer"}, "startOffset": 1602, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E22", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1611, "index": "T76", "endOffset": 1625, "text": "are vulnerable"}, "argument": [{"index": "T30", "text": "command injection attacks", "endOffset": 1654, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9119876027107239}, "startOffset": 1629, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 248, "index": "T8", "endOffset": 253, "text": "found"}, "argument": [{"index": "T9", "text": "command injection vulnerabilities", "endOffset": 317, "role": {"type": "Vulnerability"}, "startOffset": 284, "type": "Vulnerability"}, {"index": "T10", "text": "ZyXel", "endOffset": 326, "role": {"type": "Vulnerable_System"}, "startOffset": 321, "type": "Device"}, {"index": "T11", "text": "Billion routers", "endOffset": 346, "role": {"type": "Vulnerable_System"}, "startOffset": 331, "type": "Device"}, {"index": "T12", "text": "TrueOnline", "endOffset": 372, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 362, "type": "Organization"}, {"index": "T67", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Pedro_Ribeiro_(Brazilian_footballer)", "wikidataid": "Q16466585"}, "endOffset": 217, "role": {"type": "Discoverer"}, "text": "Researcher Pedro Ribeiro", "startOffset": 193, "type": "Person"}, {"index": "T25", "text": "accessible admin accounts", "endOffset": 279, "role": {"type": "Vulnerability"}, "startOffset": 254, "type": "Vulnerability"}, {"index": "T79", "text": "Agile Information Security", "endOffset": 247, "role": {"type": "Discoverer"}, "startOffset": 221, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 428, "index": "T15", "endOffset": 437, "text": "disclosed"}, "argument": [{"index": "T16", "text": "the vulnerabilities", "endOffset": 457, "role": {"type": "Vulnerability"}, "startOffset": 438, "type": "Vulnerability"}, {"index": "T17", "text": "the affected vendors", "endOffset": 558, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 538, "type": "Organization"}, {"index": "T18", "text": "last July", "endOffset": 568, "role": {"type": "Time"}, "startOffset": 559, "type": "Time"}, {"index": "T26", "text": "he", "endOffset": 427, "role": {"type": "Discoverer"}, "startOffset": 425, "type": "Person"}, {"index": "T80", "text": "Beyond Security", "endOffset": 481, "role": {"type": "Discoverer"}, "startOffset": 466, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 420, "index": "T13", "endOffset": 424, "text": "said"}, "argument": [{"index": "T68", "external_reference": {"wikidataid": "Q33690807"}, "endOffset": 419, "role": {"type": "Discoverer"}, "text": "Ribeiro", "startOffset": 412, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 128, "index": "T1", "endOffset": 147, "text": "private disclosures"}, "argument": [{"index": "T6", "text": "vendors", "endOffset": 167, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 160, "type": "Organization"}, {"index": "T7", "text": "in July", "endOffset": 175, "role": {"type": "Time"}, "startOffset": 168, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E23", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 578, "index": "T82", "endOffset": 587, "text": "published"}, "argument": [{"index": "T83", "external_reference": {"wikidataid": "Q33690807"}, "endOffset": 577, "role": {"type": "Discoverer"}, "text": "Ribeiro", "startOffset": 570, "type": "Person"}, {"index": "T81", "text": "a proof of concept exploit", "endOffset": 614, "role": {"type": "Vulnerability"}, "startOffset": 588, "type": "Vulnerability"}, {"index": "T84", "text": "yesterday", "endOffset": 624, "role": {"type": "Time"}, "startOffset": 615, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E15", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 642, "index": "T33", "endOffset": 646, "text": "told"}, "argument": [{"index": "T39", "external_reference": {"wikidataid": "Q33690807"}, "endOffset": 641, "role": {"type": "Discoverer"}, "text": "Ribeiro", "startOffset": 634, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 689, "index": "T14", "endOffset": 699, "text": "introduced"}, "argument": [{"index": "T19", "text": "the vulnerabilities", "endOffset": 719, "role": {"type": "Vulnerability"}, "startOffset": 700, "type": "Vulnerability"}, {"index": "T21", "text": "the routers", "endOffset": 767, "role": {"type": "Vulnerable_System"}, "startOffset": 756, "type": "Device"}, {"index": "T20", "text": "TrueOnline", "endOffset": 688, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 678, "type": "Organization"}, {"index": "T22", "text": "the respective manufacturers", "endOffset": 823, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 795, "type": "Organization"}, {"index": "T49", "text": "they", "endOffset": 784, "role": {"type": "Vulnerability"}, "startOffset": 780, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E18", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2174, "index": "T71", "endOffset": 2191, "text": "are also affected"}, "argument": [{"index": "T36", "text": "the tclinux variant", "endOffset": 2173, "role": {"type": "Vulnerable_System"}, "startOffset": 2154, "type": "Software"}, {"index": "T34", "text": "the command injection vulnerabilities", "endOffset": 2232, "role": {"type": "Vulnerability"}, "startOffset": 2195, "type": "Vulnerability"}, {"index": "T35", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Residential_gateway"}, "endOffset": 2144, "role": {"type": "Vulnerable_System"}, "text": "router models", "startOffset": 2131, "type": "Device"}], "subtype": "DiscoverVulnerability"}, {"index": "E14", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2357, "index": "T23", "endOffset": 2370, "text": "are available"}, "argument": [{"index": "T38", "text": "three of the vulnerabilities", "endOffset": 2403, "role": {"type": "Vulnerability"}, "startOffset": 2375, "type": "Vulnerability"}, {"index": "T37", "text": "Metasploit modules", "endOffset": 2356, "role": {"type": "Vulnerable_System"}, "startOffset": 2338, "type": "Device"}], "subtype": "DiscoverVulnerability"}, {"index": "E24", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 2437, "index": "T85", "endOffset": 2449, "text": "be exploited"}, "argument": [{"index": "T86", "text": "vulnerabilities", "endOffset": 2432, "role": {"type": "Vulnerability"}, "startOffset": 2417, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E21", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2882, "index": "T73", "endOffset": 2895, "text": "is vulnerable"}, "argument": [{"index": "T75", "text": "The ZyXel P660HN-T v1 router", "endOffset": 2881, "role": {"type": "Vulnerable_System"}, "startOffset": 2853, "type": "Device"}, {"index": "T74", "text": "command injection attack", "endOffset": 2942, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.910927414894104}, "startOffset": 2918, "type": "Capabilities"}, {"index": "T77", "text": "be exploited remotely", "endOffset": 2973, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.8946150839328766}, "startOffset": 2952, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E19", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3121, "index": "T40", "endOffset": 3129, "text": "contains"}, "argument": [{"index": "T48", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Residential_gateway"}, "endOffset": 3120, "role": {"type": "Vulnerable_System"}, "text": "router", "startOffset": 3114, "type": "Device"}, {"index": "T47", "text": "the same vulnerability", "endOffset": 3152, "role": {"type": "Vulnerability"}, "startOffset": 3130, "type": "Vulnerability"}, {"index": "T78", "text": "V2", "endOffset": 3101, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 3099, "type": "Version"}], "subtype": "DiscoverVulnerability"}, {"nugget": {"startOffset": 3165, "index": "T87", "endOffset": 3177, "text": "be exploited"}, "index": "E25", "type": "Vulnerability-related", "subtype": "DiscoverVulnerability", "realis": "Other"}, {"index": "E20", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3600, "index": "T46", "endOffset": 3618, "text": "is also vulnerable"}, "argument": [{"index": "T54", "text": "The Billion 5200W-T", "endOffset": 3599, "role": {"type": "Vulnerable_System"}, "startOffset": 3580, "type": "Device"}, {"index": "T53", "text": "command injection attacks", "endOffset": 3681, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9203411936759949}, "startOffset": 3656, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3701, "index": "T51", "endOffset": 3710, "text": "was found"}, "argument": [{"index": "T52", "text": "the vulnerability", "endOffset": 3700, "role": {"type": "Vulnerability"}, "startOffset": 3683, "type": "Vulnerability"}, {"index": "T72", "text": "its adv_remotelog.asp page", "endOffset": 3740, "role": {"type": "Vulnerable_System"}, "startOffset": 3714, "type": "Website"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "events": [{"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 4495, "index": "T55", "endOffset": 4514, "text": "are also vulnerable"}, "argument": [{"index": "T59", "text": "iBall baton routers", "endOffset": 4485, "role": {"type": "Vulnerable_System"}, "startOffset": 4466, "type": "Device"}, {"index": "T56", "text": "command injection attack", "endOffset": 4576, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9160469174385071}, "startOffset": 4552, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "events": [{"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 4864, "index": "T57", "endOffset": 4871, "text": "patched"}, "argument": [{"index": "T60", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Asus", "wikidataid": "Q152864"}, "endOffset": 4863, "role": {"type": "Releaser"}, "text": "ASUS", "startOffset": 4859, "type": "Organization"}, {"index": "T58", "text": "a bug", "endOffset": 4877, "role": {"type": "Vulnerability"}, "startOffset": 4872, "type": "Vulnerability"}, {"index": "T61", "text": "allowed attackers to pair two vulnerabilities", "endOffset": 4928, "role": {"CAPEC-Meta": "Man in the Middle Attack", "type": "Issues-Addressed", "confidence": 0.910667896270752}, "startOffset": 4883, "type": "Capabilities"}, {"index": "T62", "text": "execute commands as root", "endOffset": 4986, "role": {"CAPEC-Meta": "Authentication Abuse", "type": "Issues-Addressed", "confidence": 0.8914952874183655}, "startOffset": 4962, "type": "Capabilities"}, {"index": "T90", "text": "gain direct router access", "endOffset": 4957, "role": {"CAPEC-Meta": "Privilege Abuse", "type": "Issues-Addressed", "confidence": 0.9267163574695587}, "startOffset": 4932, "type": "Capabilities"}], "subtype": "PatchVulnerability"}]}, {"index": 3, "events": [{"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 5072, "index": "T63", "endOffset": 5080, "text": "patching"}, "argument": [{"index": "T65", "text": "January", "endOffset": 5027, "role": {"type": "Time"}, "startOffset": 5020, "type": "Time"}, {"index": "T64", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 5094, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 5085, "type": "Organization"}, {"index": "T89", "text": "Spectre", "endOffset": 5018, "role": {"type": "Vulnerability"}, "startOffset": 5011, "type": "Vulnerability"}, {"index": "T88", "text": "Meltdown", "endOffset": 5006, "role": {"type": "Vulnerability"}, "startOffset": 4998, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}]}, {"index": 4, "events": [{"index": "E13", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 97, "index": "T66", "endOffset": 114, "text": "were published on"}, "argument": [{"index": "T3", "text": "a major Thai ISP", "endOffset": 96, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 80, "type": "Organization"}, {"index": "T4", "external_reference": {"wikidataid": "Q5318"}, "endOffset": 57, "role": {"type": "Vulnerable_System"}, "text": "routers", "startOffset": 50, "type": "Device"}, {"index": "T2", "text": "serious vulnerabilities", "endOffset": 34, "role": {"type": "Vulnerability"}, "startOffset": 11, "type": "Vulnerability"}, {"index": "T5", "text": "Monday", "endOffset": 121, "role": {"type": "Time"}, "startOffset": 115, "type": "Time"}], "subtype": "DiscoverVulnerability"}]}, {"index": 5, "events": [{"index": "E17", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 947, "index": "T69", "endOffset": 967, "text": "were being developed"}, "argument": [{"index": "T50", "text": "patches", "endOffset": 946, "role": {"type": "Patch"}, "startOffset": 939, "type": "Patch"}], "subtype": "PatchVulnerability"}]}]}, "info": {"title": "Router Vulnerabilities Disclosed in July Remain Unpatched | Threatpost | The first stop for security news", "date": "2017_01_18", "type": "text", "link": "https://threatpost.com/router-vulnerabilities-disclosed-in-july-remain-unpatched/123115/"}}