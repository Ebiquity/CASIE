{"content": "Netskope Threat Research Labs has observed phishing attacks using decoy PDF files, URL redirection, and Cloud Storage services to infect users and propagate malware. Because many organizations have default \u201callow\u201d security policies for popular Cloud Storage services and PDF readers to let users take advantage of these useful services, these attacks pass through the corporate network to end users\u2019 machines undetected. Moreover, as users collaborate and share through cloud services, these malicious files posing as PDFs \u201cfan out\u201d to shared users, creating a secondary propagation vector. We are calling this the \u201cCloudPhishing Fan-out Effect\u201d. In this blog, we will detail the insidious nature of CloudPhishing and the secondary fan-out using two recently detected cases. We will also illustrate how an attack \u2013 even if unsuccessful \u2013 may leave the target vulnerable to future attacks. Additionally, we will outline the Netskope protection stance, and general best practices to handle this attack. The CloudPhishing fan-out effect occurs when a victim inadvertently shares the phishing document with colleagues, whether internal or external, via a cloud service. This is particularly insidious in the cloud, as shared users lose the context of the document\u2019s external origin and may trust the internally shared document as if it were created internally. Other than having the file shared in OneDrive, the SaaS application is unrelated to the attack. This threat, seen in one of our customer environments, is detected by Netskope Active Threat Protection as Backdoor.Phishing.FW. The decoy PDF is usually delivered as an email attachment named,\u201cinvoice\u201d in an attempt to lure the victim into executing the file. This, in effect, weakens the security posture of the endpoint against future attacks. The decoy PDF connects to the TinyURL link, http://TinyURL[. The attacker used the TinyURL link as an evasive tactic to hide the original link. At the time of analysis, the web page was down and not serving any content. This might be because the web page was removed or renamed. Our analysis showed that the Adobe Acrobat Reader prompts a security warning to the user when the document connects to a link. This feature allows any URL related to the domain that is on the allowed list. Based on the behavior seen in the latest version of the Adobe Acrobat Reader, we recommend users un-check the \u201cRemember this action\u2026\u201d option while allowing the PDF to connect to an external link. We also advise users to hover their mouse over the hyperlink to confirm the link and also regularly monitor managed Internet access settings in the PDF reader\u2019s Trust Manager. The phishing PDF decoys showcase the use of URL redirectors and cloud services, and also a secondary propagation vector within the shared users leading to the CloudPhishing fan-out. By taking advantage of the \u201cdefault allow\u201d action in popular PDF readers, the attacker can easily deploy multiple attacks without getting the security warning after the first alert. This makes the attacker effectively a host for phishing pages or malicious payloads using URL redirection services and Cloud Storage services", "sourcefile": "265.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E9", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1607, "index": "T21", "endOffset": 1616, "text": "delivered"}, "argument": [{"index": "T22", "text": "The decoy PDF", "endOffset": 1595, "role": {"type": "Tool"}, "startOffset": 1582, "type": "File"}, {"index": "T19", "text": "invoice", "endOffset": 1654, "role": {"type": "Trusted-Entity"}, "startOffset": 1647, "type": "File"}], "subtype": "Phishing"}, {"index": "E1", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1673, "index": "T26", "endOffset": 1677, "text": "lure"}, "argument": [{"index": "T23", "text": "executing the file", "endOffset": 1712, "role": {"type": "Purpose", "subtype": "Malware spreading", "confidence": 0.8569664359092712}, "startOffset": 1694, "type": "Purpose"}, {"index": "T27", "text": "victim", "endOffset": 1688, "role": {"type": "Victim"}, "startOffset": 1682, "type": "Person"}], "subtype": "Phishing"}]}, {"index": 1, "events": [{"index": "E2", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 43, "index": "T2", "endOffset": 59, "text": "phishing attacks"}, "argument": [{"index": "T5", "text": "PDF files", "endOffset": 81, "role": {"type": "Trusted-Entity"}, "startOffset": 72, "type": "File"}, {"index": "T3", "text": "URL redirection", "endOffset": 98, "role": {"type": "Trusted-Entity"}, "startOffset": 83, "type": "System"}, {"index": "T4", "external_reference": {"wikidataid": "Q60021770"}, "endOffset": 126, "role": {"type": "Trusted-Entity"}, "text": "Cloud Storage services", "startOffset": 104, "type": "System"}, {"index": "T1", "text": "using decoy", "endOffset": 71, "role": {"CAPEC-Meta": "Excavation", "type": "Attack-Pattern", "confidence": 0.8862989246845245}, "startOffset": 60, "type": "Capabilities"}, {"index": "T6", "text": "propagate malware", "endOffset": 164, "role": {"type": "Purpose", "subtype": "Malware spreading", "confidence": 0.9437832236289978}, "startOffset": 147, "type": "Purpose"}, {"index": "T28", "text": "infect users", "endOffset": 142, "role": {"type": "Purpose", "subtype": "Malware spreading", "confidence": 0.8924789428710938}, "startOffset": 130, "type": "Purpose"}], "subtype": "Phishing"}]}, {"index": 2, "events": [{"index": "E12", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 2812, "index": "T29", "endOffset": 2837, "text": "the CloudPhishing fan-out"}, "argument": [{"index": "T24", "text": "the shared users", "endOffset": 2800, "role": {"type": "Victim"}, "startOffset": 2784, "type": "Person"}], "subtype": "Phishing"}]}, {"index": 3, "events": [{"index": "E3", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 508, "index": "T7", "endOffset": 517, "text": "posing as"}, "argument": [{"index": "T8", "text": "these malicious files", "endOffset": 507, "role": {"type": "Tool"}, "startOffset": 486, "type": "File"}, {"index": "T11", "text": "creating a secondary propagation vector", "endOffset": 589, "role": {"CAPEC-Meta": "Flooding", "type": "Attack-Pattern", "confidence": 0.91130530834198}, "startOffset": 550, "type": "Capabilities"}, {"index": "T12", "text": "users", "endOffset": 439, "role": {"type": "Victim"}, "startOffset": 434, "type": "Person"}, {"index": "T10", "text": "shared users", "endOffset": 548, "role": {"type": "Victim"}, "startOffset": 536, "type": "Person"}, {"index": "T9", "text": "PDFs", "endOffset": 522, "role": {"type": "Trusted-Entity"}, "startOffset": 518, "type": "File"}, {"index": "T25", "text": "share through cloud services", "endOffset": 484, "role": {"CAPEC-Meta": "Shared Data Manipulation", "type": "Attack-Pattern", "confidence": 0.886403501033783}, "startOffset": 456, "type": "Capabilities"}], "subtype": "Phishing"}]}, {"index": 4, "events": [{"index": "E7", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1001, "index": "T16", "endOffset": 1033, "text": "The CloudPhishing fan-out effect"}, "argument": [{"index": "T17", "text": "colleagues", "endOffset": 1113, "role": {"type": "Victim"}, "startOffset": 1103, "type": "Person"}, {"index": "T20", "text": "a cloud service", "endOffset": 1164, "role": {"type": "Trusted-Entity"}, "startOffset": 1149, "type": "System"}, {"index": "T15", "text": "shares the phishing document", "endOffset": 1097, "role": {"CAPEC-Meta": "Infrastructure Manipulation", "type": "Attack-Pattern", "confidence": 0.9100957810878754}, "startOffset": 1069, "type": "Capabilities"}, {"index": "T18", "text": "a victim", "endOffset": 1054, "role": {"type": "Victim"}, "startOffset": 1046, "type": "Person"}], "subtype": "Phishing"}]}, {"index": 5, "events": [{"nugget": {"startOffset": 616, "index": "T13", "endOffset": 644, "text": "CloudPhishing Fan-out Effect"}, "index": "E4", "type": "Attack", "subtype": "Phishing", "realis": "Generic"}]}, {"index": 6, "events": [{"nugget": {"startOffset": 700, "index": "T14", "endOffset": 713, "text": "CloudPhishing"}, "index": "E5", "type": "Attack", "subtype": "Phishing", "realis": "Generic"}]}]}, "info": {"title": "Decoys, Phishing, and the Cloud: The Latest Fan-out Effect - Netskope", "date": "2017_01_19", "type": "text", "link": "https://resources.netskope.com/h/i/321341739-decoys-phishing-and-the-cloud-the-latest-fan-out-effect"}}