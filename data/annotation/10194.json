{"content": "A flaw in Safari \u2013 that allows an attacker to spoof websites and trick victims into handing over their credentials \u2013 has yet to be patched. A browser address bar spoofing flaw was found by researchers this week in Safari \u2013 and Apple has yet issue a patch for the flaw. Researcher Rafay Baloch on Monday disclosed two proof-of-concepts revealing how vulnerabilities in Edge browser 42.17134.1.0 and Safari iOS 11.3.1 could be abused to manipulate the browsers\u2019 address bars, tricking victims into thinking they are visiting a legitimate website. Baloch told Threatpost Wednesday that Apple has promised to fix the flaw in its next security update for Safari. \u201cApple has told [me] that the latest beta of iOS 12 also addresses the issue, however they haven\u2019t provided any dates,\u201d he said. Apple did not respond to multiple requests for comment from Threatpost. Microsoft for its part has fixed the vulnerability Baloch found in the Edge browser, (CVE-2018-8383) in its August Patch Tuesday release. According to Microsoft\u2019s vulnerability advisory released August 14, the spoofing flaw exists because Edge does not properly parse HTTP content. Both flaws stem from the Edge and Safari browsers allowing JavaScript to update the address bar while the page is still loading. This means that an attacker could request data from a non-existent port and, due to the delay induced by the setInterval function, trigger the address bar spoofing. The browser would then preserve the address bar and load the content from the spoofed page, Baloch said in his blog breaking down both vulnerabilities. From there, the attacker could spoof the website, using it to lure in victims and potentially gather credentials or spread malware. For instance, the attacker could send an email message containing the specially crafted URL to the user, convince the user to click it, and take them to the link which could gather their credentials or sensitive information. \u201cAs per Google, Address bar is the only reliable indicator for ensuring the identity of the website, if the Address bar points to Facebook.com and the content is hosted on attacker\u2019s website, there is no reason why someone would not fall for this,\u201d Baloch told Threatpost. In a video demonstration, Baloch showed how he could visit a link for the vulnerable browser on Edge (http://sh3ifu[.]com/bt/Edge-Spoof.html), which would take him to a site purporting to be Gmail login. However, while the URL points to a Gmail address, the content is hosted on sh3ifu.com, said Baloch. The Safari proof-of-concept is similar, except for one constraint where it does not allow users to type their information into the input boxes while the page is in a loading state. However, Bolach said he was able to circumvent this restriction by injecting a fake keyboard using Javascript \u2013 a common practice in banking sites. No other browsers \u2013 including Chrome or Firefox \u2013 were discovered to have the flaw, said Baloch. Baloch is known for discovering similar vulnerabilities in Chrome, Firefox and other major browsers in 2016, which also allowed attackers to spoof URLs in the address bar. The vulnerabilities were disclosed to both Microsoft and Apple and Baloch gave both a 90-day deadline before he went public with the flaws. Due to the Safari browser bug being unpatched, Baloch said he has not yet released a Proof of Concept: \u201cHowever considering there is a slight difference between the Edge browser POC and Safari, anyone with decent knowledge of Javascript can make it work on Safari,\u201d he told us.", "sourcefile": "10194.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 46, "index": "T1", "endOffset": 51, "text": "spoof"}, "argument": [{"index": "T5", "text": "websites", "endOffset": 60, "role": {"type": "Trusted-Entity"}, "startOffset": 52, "type": "Website"}, {"index": "T6", "text": "an attacker", "endOffset": 42, "role": {"type": "Attacker"}, "startOffset": 31, "type": "Person"}], "subtype": "Phishing"}, {"index": "E2", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 65, "index": "T2", "endOffset": 70, "text": "trick"}, "argument": [{"index": "T3", "text": "victims", "endOffset": 78, "role": {"type": "Victim"}, "startOffset": 71, "type": "Person"}, {"index": "T4", "text": "handing over their credentials", "endOffset": 114, "role": {"type": "Purpose", "subtype": "Gathering data", "confidence": 0.9324459135532379}, "startOffset": 84, "type": "Purpose"}], "subtype": "Phishing"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 303, "index": "T21", "endOffset": 312, "text": "disclosed"}, "argument": [{"index": "T20", "text": "Monday", "endOffset": 302, "role": {"type": "Time"}, "startOffset": 296, "type": "Time"}, {"index": "T19", "text": "Researcher Rafay Baloch", "endOffset": 292, "role": {"type": "Discoverer"}, "startOffset": 269, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 335, "index": "T22", "endOffset": 344, "text": "revealing"}, "argument": [{"index": "T26", "text": "tricking victims into thinking they are visiting a legitimate website", "endOffset": 543, "role": {"CAPEC-Meta": "Excavation", "type": "Capabilities", "confidence": 0.8871904611587524}, "startOffset": 474, "type": "Capabilities"}, {"index": "T25", "external_reference": {"wikidataid": "Q70060004"}, "endOffset": 404, "role": {"type": "Vulnerable_System"}, "text": "Safari", "startOffset": 398, "type": "Software"}, {"index": "T23", "text": "vulnerabilities", "endOffset": 364, "role": {"type": "Vulnerability"}, "startOffset": 349, "type": "Vulnerability"}, {"index": "T24", "external_reference": {"wikidataid": "Q18698690"}, "endOffset": 380, "role": {"type": "Vulnerable_System"}, "text": "Edge browser", "startOffset": 368, "type": "Software"}, {"index": "T85", "text": "42.17134.1.0", "endOffset": 393, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 381, "type": "Version"}, {"index": "T86", "text": "iOS 11.3.1", "endOffset": 415, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 405, "type": "Version"}, {"index": "T89", "text": "manipulate the browsers\u2019 address bars", "endOffset": 472, "role": {"CAPEC-Meta": "File Manipulation", "type": "Capabilities", "confidence": 0.9028121531009674}, "startOffset": 435, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 176, "index": "T11", "endOffset": 185, "text": "was found"}, "argument": [{"index": "T10", "text": "A browser address bar spoofing flaw", "endOffset": 175, "role": {"type": "Vulnerability"}, "startOffset": 140, "type": "Vulnerability"}, {"index": "T12", "text": "researchers", "endOffset": 200, "role": {"type": "Discoverer"}, "startOffset": 189, "type": "Person"}, {"index": "T13", "text": "this week", "endOffset": 210, "role": {"type": "Time"}, "startOffset": 201, "type": "Time"}, {"index": "T14", "external_reference": {"wikidataid": "Q70060004"}, "endOffset": 220, "role": {"type": "Vulnerable_System"}, "text": "Safari", "startOffset": 214, "type": "Software"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "relation": "Same", "events": [{"index": "E13", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1618, "index": "T47", "endOffset": 1623, "text": "spoof"}, "argument": [{"index": "T49", "text": "the website", "endOffset": 1635, "role": {"type": "Trusted-Entity"}, "startOffset": 1624, "type": "Website"}, {"index": "T48", "text": "the attacker", "endOffset": 1611, "role": {"type": "Attacker"}, "startOffset": 1599, "type": "Person"}], "subtype": "Phishing"}, {"index": "E14", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1649, "index": "T50", "endOffset": 1653, "text": "lure"}, "argument": [{"index": "T52", "text": "gather credentials", "endOffset": 1699, "role": {"type": "Purpose", "subtype": "Gathering data", "confidence": 0.9355685710906982}, "startOffset": 1681, "type": "Purpose"}, {"index": "T51", "text": "victims", "endOffset": 1664, "role": {"type": "Victim"}, "startOffset": 1657, "type": "Person"}, {"index": "T90", "text": "spread malware", "endOffset": 1717, "role": {"type": "Purpose", "subtype": "Malware spreading", "confidence": 0.9458524584770203}, "startOffset": 1703, "type": "Purpose"}], "subtype": "Phishing"}]}, {"index": 3, "relation": "Same", "events": [{"index": "E3", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 117, "index": "T8", "endOffset": 138, "text": "has yet to be patched"}, "argument": [{"index": "T7", "text": "A flaw", "endOffset": 6, "role": {"type": "Vulnerability"}, "startOffset": 0, "type": "Vulnerability"}, {"index": "T9", "external_reference": {"wikidataid": "Q70060004"}, "endOffset": 16, "role": {"type": "Vulnerable_System"}, "text": "Safari", "startOffset": 10, "type": "Software"}], "subtype": "PatchVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 233, "index": "T16", "endOffset": 246, "text": "has yet issue"}, "argument": [{"index": "T15", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apple_Inc.", "wikidataid": "Q312"}, "endOffset": 232, "role": {"type": "Releaser"}, "text": "Apple", "startOffset": 227, "type": "Organization"}, {"index": "T17", "text": "a patch", "endOffset": 254, "role": {"type": "Patch"}, "startOffset": 247, "type": "Patch"}, {"index": "T18", "text": "the flaw", "endOffset": 267, "role": {"type": "Vulnerability"}, "startOffset": 259, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 605, "index": "T28", "endOffset": 608, "text": "fix"}, "argument": [{"index": "T27", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apple_Inc.", "wikidataid": "Q312"}, "endOffset": 588, "role": {"type": "Releaser"}, "text": "Apple", "startOffset": 583, "type": "Organization"}, {"index": "T29", "text": "the flaw", "endOffset": 617, "role": {"type": "Vulnerability"}, "startOffset": 609, "type": "Vulnerability"}, {"index": "T30", "text": "its next security update", "endOffset": 645, "role": {"type": "Patch"}, "startOffset": 621, "type": "Patch"}, {"index": "T31", "external_reference": {"wikidataid": "Q70060004"}, "endOffset": 656, "role": {"type": "Vulnerable_System"}, "text": "Safari", "startOffset": 650, "type": "Software"}], "subtype": "PatchVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 715, "index": "T33", "endOffset": 724, "text": "addresses"}, "argument": [{"index": "T32", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/IOS"}, "endOffset": 709, "role": {"type": "Vulnerable_System"}, "text": "iOS 12", "startOffset": 703, "type": "System"}, {"index": "T34", "text": "the issue", "endOffset": 734, "role": {"type": "Vulnerability"}, "startOffset": 725, "type": "Vulnerability"}, {"index": "T87", "text": "latest beta", "endOffset": 699, "role": {"type": "Patch-Number"}, "startOffset": 688, "type": "Version"}], "subtype": "PatchVulnerability"}, {"index": "E21", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 3289, "index": "T82", "endOffset": 3304, "text": "being unpatched"}, "argument": [{"index": "T83", "text": "the Safari browser bug", "endOffset": 3288, "role": {"type": "Vulnerability"}, "startOffset": 3266, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}]}, {"index": 4, "relation": "Same", "events": [{"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 882, "index": "T35", "endOffset": 891, "text": "has fixed"}, "argument": [{"index": "T36", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 868, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 859, "type": "Organization"}, {"index": "T37", "text": "the vulnerability", "endOffset": 909, "role": {"type": "Vulnerability"}, "startOffset": 892, "type": "Vulnerability"}, {"index": "T42", "text": "release", "endOffset": 995, "role": {"type": "Patch"}, "startOffset": 988, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1036, "index": "T43", "endOffset": 1053, "text": "advisory released"}, "argument": [{"index": "T44", "text": "vulnerability", "endOffset": 1035, "role": {"type": "Vulnerability"}, "startOffset": 1022, "type": "Vulnerability"}, {"index": "T45", "text": "August 14", "endOffset": 1063, "role": {"type": "Time"}, "startOffset": 1054, "type": "Time"}, {"index": "T46", "text": "the spoofing flaw", "endOffset": 1082, "role": {"type": "Vulnerability"}, "startOffset": 1065, "type": "Vulnerability"}, {"index": "T88", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 1019, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 1010, "type": "Organization"}], "subtype": "PatchVulnerability"}]}, {"index": 5, "relation": "Same", "events": [{"index": "E17", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2900, "index": "T63", "endOffset": 2915, "text": "were discovered"}, "argument": [{"index": "T64", "text": "the flaw", "endOffset": 2932, "role": {"type": "Vulnerability"}, "startOffset": 2924, "type": "Vulnerability"}, {"index": "T66", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Firefox"}, "endOffset": 2897, "role": {"type": "Vulnerable_System"}, "text": "Firefox", "startOffset": 2890, "type": "System"}, {"index": "T65", "external_reference": {"wikidataid": "Q777"}, "endOffset": 2886, "role": {"type": "Vulnerable_System"}, "text": "Chrome", "startOffset": 2880, "type": "Software"}], "subtype": "DiscoverVulnerability"}, {"index": "E18", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2967, "index": "T68", "endOffset": 2978, "text": "discovering"}, "argument": [{"index": "T67", "external_reference": {"wikidataid": "Q22973747"}, "endOffset": 2953, "role": {"type": "Discoverer"}, "text": "Baloch", "startOffset": 2947, "type": "Person"}, {"index": "T69", "text": "vulnerabilities", "endOffset": 3002, "role": {"type": "Vulnerability"}, "startOffset": 2987, "type": "Vulnerability"}, {"index": "T70", "external_reference": {"wikidataid": "Q777"}, "endOffset": 3012, "role": {"type": "Vulnerable_System"}, "text": "Chrome", "startOffset": 3006, "type": "Software"}, {"index": "T71", "external_reference": {"wikidataid": "Q698"}, "endOffset": 3021, "role": {"type": "Vulnerable_System"}, "text": "Firefox", "startOffset": 3014, "type": "Software"}, {"index": "T72", "text": "other major browsers", "endOffset": 3046, "role": {"type": "Vulnerable_System"}, "startOffset": 3026, "type": "Software"}, {"index": "T73", "text": "2016", "endOffset": 3054, "role": {"type": "Time"}, "startOffset": 3050, "type": "Time"}, {"index": "T74", "text": "allowed attackers to spoof URLs in the address bar", "endOffset": 3117, "role": {"CAPEC-Meta": "Resource Leak Exposure", "type": "Capabilities", "confidence": 0.898549497127533}, "startOffset": 3067, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E19", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3139, "index": "T76", "endOffset": 3153, "text": "were disclosed"}, "argument": [{"index": "T75", "text": "The vulnerabilities", "endOffset": 3138, "role": {"type": "Vulnerability"}, "startOffset": 3119, "type": "Vulnerability"}, {"index": "T84", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Apple_Inc.", "wikidataid": "Q312"}, "endOffset": 3181, "role": {"type": "Vulnerable_System_Owner"}, "text": "Apple", "startOffset": 3176, "type": "Organization"}, {"index": "T77", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 3171, "role": {"type": "Vulnerable_System_Owner"}, "text": "Microsoft", "startOffset": 3162, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E20", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3231, "index": "T79", "endOffset": 3242, "text": "went public"}, "argument": [{"index": "T81", "text": "the flaws", "endOffset": 3257, "role": {"type": "Vulnerability"}, "startOffset": 3248, "type": "Vulnerability"}, {"index": "T80", "text": "he", "endOffset": 3230, "role": {"type": "Discoverer"}, "startOffset": 3228, "type": "Person"}, {"index": "T78", "external_reference": {"wikidataid": "Q22973747"}, "endOffset": 3192, "role": {"type": "Discoverer"}, "text": "Baloch", "startOffset": 3186, "type": "Person"}], "subtype": "DiscoverVulnerability"}]}, {"index": 6, "events": [{"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 917, "index": "T39", "endOffset": 922, "text": "found"}, "argument": [{"index": "T38", "external_reference": {"wikidataid": "Q22973747"}, "endOffset": 916, "role": {"type": "Discoverer"}, "text": "Baloch", "startOffset": 910, "type": "Person"}, {"index": "T40", "external_reference": {"wikidataid": "Q18698690"}, "endOffset": 942, "role": {"type": "Vulnerable_System"}, "text": "the Edge browser", "startOffset": 926, "type": "Software"}, {"index": "T41", "text": "CVE-2018-8383", "endOffset": 958, "role": {"type": "CVE"}, "startOffset": 945, "type": "CVE"}], "subtype": "DiscoverVulnerability"}]}, {"index": 7, "events": [{"index": "E15", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 1752, "index": "T53", "endOffset": 1756, "text": "send"}, "argument": [{"index": "T55", "text": "an email message", "endOffset": 1773, "role": {"type": "Tool"}, "startOffset": 1757, "type": "File"}, {"index": "T54", "text": "the attacker", "endOffset": 1745, "role": {"type": "Attacker"}, "startOffset": 1733, "type": "Person"}, {"index": "T56", "text": "the specially crafted URL", "endOffset": 1810, "role": {"type": "Tool"}, "startOffset": 1785, "type": "Website"}, {"index": "T57", "text": "the user", "endOffset": 1822, "role": {"type": "Victim"}, "startOffset": 1814, "type": "Person"}, {"index": "T58", "text": "convince the user to click it", "endOffset": 1853, "role": {"CAPEC-Meta": "Software Integrity Attack", "type": "Attack-Pattern", "confidence": 0.90052130818367}, "startOffset": 1824, "type": "Capabilities"}, {"index": "T59", "text": "gather their credentials or sensitive information", "endOffset": 1942, "role": {"type": "Purpose", "subtype": "Gathering data", "confidence": 0.9079915583133698}, "startOffset": 1893, "type": "Purpose"}], "subtype": "Phishing"}]}, {"index": 8, "events": [{"index": "E16", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 2391, "index": "T61", "endOffset": 2407, "text": "purporting to be"}, "argument": [{"index": "T62", "external_reference": {"wikidataid": "Q9334"}, "endOffset": 2419, "role": {"type": "Trusted-Entity"}, "text": "Gmail login", "startOffset": 2408, "type": "System"}, {"index": "T60", "text": "a site", "endOffset": 2390, "role": {"type": "Tool"}, "startOffset": 2384, "type": "Website"}], "subtype": "Phishing"}]}]}, "info": {"title": "Apple Yet to Patch Safari Browser Address Bar Spoofing Flaw", "date": "2018_09_12", "type": "text", "link": "https://threatpost.com/apple-yet-to-patch-safari-browser-address-bar-spoofing-flaw/137395/"}}