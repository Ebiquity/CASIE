{"content": "Using an SSL proxy that simplistically stored certificates, Kaspersky Anti-Virus left its users open to TLS certificate collisions. By Chris Duckett Google's Project Zero has found that it was previously trivial to create an SSL certificate collision thanks to Kaspersky using only the first 32 bits of an MD5 hash in its SSL proxy packaged with its Anti-Virus product. \"You don't have to be a cryptographer to understand a 32-bit key is not enough to prevent brute-forcing a collision in seconds,\" Tavis Ormandy of Project Zero said in its issue tracker. \"They effectively proxy SSL connections, inserting their own certificate as a trusted authority in the system store and then replace all leaf certificates on the fly. This is why if you examine a certificate when using Kaspersky Anti-Virus, the issuer appears to be 'Kaspersky Anti-Virus Personal Root',\" he said. \"It seems incredible that Kaspersky haven't noticed that they sometimes get certificate errors for mismatching commonNames just by random chance. After Ormandy reported the bug and received acknowledgement from Kaspersky on November 1, despite learning the security vendor was doing some commonName checks, the bug was still able to be exploited. \"If you're not being attacked, you would see random errors. A MITM [man in the middle] can send you packets from where you were expecting,\" Ormandy said on Twitter. Ormandy also found another bug on November 12 that allowed any unprivileged user to become a local certificate authority. In May last year, the Project Zero security researcher discovered that Symantec Antivirus Engine was vulnerable to buffer overflow when parsing malformed portable-executable header files that resulted in instant blue-screening and kernel memory corruption without user action on Windows. \"This is about as bad as it can possibly get,\" Ormandy said at the time. Because Symantec use a filter driver to intercept all system I/O, just emailing a file to a victim or sending them a link is enough to exploit it.", "sourcefile": "38.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 171, "index": "T2", "endOffset": 180, "text": "has found"}, "argument": [{"index": "T6", "text": "Anti-Virus product", "endOffset": 368, "role": {"type": "Vulnerable_System"}, "startOffset": 350, "type": "Software"}, {"index": "T5", "text": "SSL proxy packaged", "endOffset": 340, "role": {"type": "Vulnerable_System"}, "startOffset": 322, "type": "Software"}, {"index": "T3", "external_reference": {"wikidataid": "Q18859887"}, "endOffset": 170, "role": {"type": "Discoverer"}, "text": "Project Zero", "startOffset": 158, "type": "Organization"}, {"index": "T1", "text": "an SSL certificate collision", "endOffset": 250, "role": {"type": "Vulnerability"}, "startOffset": 222, "type": "Vulnerability"}, {"index": "T4", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Kaspersky_Lab", "wikidataid": "Q489943"}, "endOffset": 270, "role": {"type": "Vulnerable_System_Owner"}, "text": "Kaspersky", "startOffset": 261, "type": "Organization"}, {"index": "T26", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Google", "wikidataid": "Q95"}, "endOffset": 155, "role": {"type": "Discoverer"}, "text": "Google", "startOffset": 149, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1030, "index": "T18", "endOffset": 1038, "text": "reported"}, "argument": [{"index": "T20", "text": "the bug", "endOffset": 1046, "role": {"type": "Vulnerability"}, "startOffset": 1039, "type": "Vulnerability"}, {"index": "T19", "external_reference": {"wikidataid": "Q344023"}, "endOffset": 1029, "role": {"type": "Discoverer"}, "text": "Ormandy", "startOffset": 1022, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1051, "index": "T24", "endOffset": 1075, "text": "received acknowledgement"}, "argument": [{"index": "T21", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Kaspersky_Lab", "wikidataid": "Q489943"}, "endOffset": 1090, "role": {"type": "Vulnerable_System_Owner"}, "text": "Kaspersky", "startOffset": 1081, "type": "Organization"}, {"index": "T22", "text": "November 1", "endOffset": 1104, "role": {"type": "Time"}, "startOffset": 1094, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 1203, "index": "T27", "endOffset": 1215, "text": "be exploited"}, "argument": [{"index": "T28", "text": "bug", "endOffset": 1184, "role": {"type": "Vulnerability"}, "startOffset": 1181, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1390, "index": "T8", "endOffset": 1400, "text": "also found"}, "argument": [{"index": "T9", "text": "another bug", "endOffset": 1412, "role": {"type": "Vulnerability"}, "startOffset": 1401, "type": "Vulnerability"}, {"index": "T7", "external_reference": {"wikidataid": "Q344023"}, "endOffset": 1389, "role": {"type": "Discoverer"}, "text": "Ormandy", "startOffset": 1382, "type": "Person"}, {"index": "T10", "text": "November 12", "endOffset": 1427, "role": {"type": "Time"}, "startOffset": 1416, "type": "Time"}, {"index": "T11", "text": "allowed any unprivileged user to become a local certificate authority", "endOffset": 1502, "role": {"CAPEC-Meta": "Privilege Abuse", "type": "Capabilities", "confidence": 0.9150767922401428}, "startOffset": 1433, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1559, "index": "T12", "endOffset": 1569, "text": "discovered"}, "argument": [{"index": "T16", "text": "the Project Zero security researcher", "endOffset": 1558, "role": {"type": "Discoverer"}, "startOffset": 1522, "type": "Person"}, {"index": "T13", "external_reference": {"wikidataid": "Q741128"}, "endOffset": 1600, "role": {"type": "Vulnerable_System"}, "text": "Symantec Antivirus Engine", "startOffset": 1575, "type": "Software"}, {"index": "T14", "text": "buffer overflow", "endOffset": 1634, "role": {"type": "Vulnerability"}, "startOffset": 1619, "type": "Vulnerability"}, {"index": "T15", "text": "instant blue-screening", "endOffset": 1730, "role": {"CAPEC-Meta": "File Manipulation", "type": "Capabilities", "confidence": 0.9195775389671326}, "startOffset": 1708, "type": "Capabilities"}, {"index": "T23", "text": "kernel memory corruption", "endOffset": 1759, "role": {"CAPEC-Meta": "Pointer Manipulation", "type": "Capabilities", "confidence": 0.896827906370163}, "startOffset": 1735, "type": "Capabilities"}, {"index": "T17", "text": "May last year", "endOffset": 1520, "role": {"type": "Time"}, "startOffset": 1507, "type": "Time"}, {"index": "T25", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 1790, "role": {"type": "Supported_Platform"}, "text": "Windows", "startOffset": 1783, "type": "System"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "Project Zero calls out Kaspersky AV for SSL interception practices | ZDNet", "date": "2017_01_04", "type": "text", "link": "http://www.zdnet.com/article/project-zero-calls-out-kaspersky-av-for-ssl-interception-practices/"}}