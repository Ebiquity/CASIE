{"content": "There\u2019s no question that Friday\u2019s WannaCry ransomware attack, which spread like wildfire, was bad. Its ability to spread like a worm by exploiting a Microsoft vulnerability was certainly new ground for a ransomware campaign. But along the way, there\u2019s been a lot of fear and hype. Perspective is in order. Here\u2019s a look at the latest in Sophos\u2019 investigation, including a recap of how it is protecting customers. From there, we look at how this fits into overall attack trends and how, in the grand scheme of things, this doesn\u2019t represent a falling sky. With the code behind Friday\u2019s attack in the wild, we should\u00a0expect copycats to cook up their own campaigns\u00a0in the coming days\u00a0to capitalize on the money-making opportunity in front of them. Over the weekend, accounts set up to collect ransom payments had received smaller amounts than expected for an attack of this size. But by Monday morning, the balances were on the rise, suggesting that more people were responding to the ransom message Monday. On Saturday, three ransomware-associated wallets had received 92 bitcoin payments totaling $26,407.85 USD. By Sunday, the number between the three wallets was up to $30,706.61 USD. By Monday morning, 181 payments had been made totaling 29.46564365 BTC ($50,504.23 USD). Analysis seems to confirm that Friday\u2019s attack was launched using suspected NSA code leaked by a group of hackers known as the Shadow Brokers. It used a variant of the Shadow Brokers\u2019 APT EternalBlue Exploit (CC-1353), and used strong encryption on files such as documents, images, and videos. A perfect attack would self-propagate but would do so slowly, randomly and unpredictably. This one was full throttle, but hardly to its detriment. Here we had something that spread like wildfire, but the machines that were impacted were probably still susceptible to secondary attacks because the underlying vulnerability probably hasn\u2019t been patched. The problem is that exploit and payload are separate. The payload went fast and got stopped, but that\u2019s just one of an infinite number of possibilities that can spread through the unsolved exploit. Companies still using Windows XP are particularly susceptible to this sort of attack. First launched in 2001, the operating system is now 16 years old and has been superseded by Windows Vista and Windows 7, 8 and 10 upgrades. It remains to be seen who was behind this attack. Sophos is cooperating with law enforcement to provide any intelligence it can gather about the origins and attack vectors. The company believes initial infections may have arrived via an email with a malicious payload that a user was tricked into opening. Sophos continues to update protections against the threat. Sophos Customers using Intercept X and Sophos EXP products will also see this ransomware blocked by CryptoGuard. Please note that while Intercept X and EXP will block the underlying behavior and restore deleted or encrypted files in all cases we have seen, the offending ransomware splash screen and note may still appear. For updates on the specific strains being blocked, Sophos is continually updating a Knowledge-Base Article on the subject. Meanwhile, everyone is urged to update their Windows environments as described in\u00a0Microsoft Security Bulletin MS17-010 \u2013 Critical. For those using older versions of Windows, Microsoft has provided\u00a0Customer Guidance for WannaCrypt attacks and has made the decision to make the Security Update for platforms in custom support only \u2013 Windows XP, Windows 8, and Windows Server 2003 \u2013 broadly available for download. As severe as this attack was, it\u2019s important to note that we\u2019re not looking at a shift in the overall attack trend. This attack represents a merging of old behaviors into a perfect storm.\u00a0SophosLabs VP Simon Reed said: This attack demonstrates the opportunistic nature of commercial malware authors to re-use the most powerful of exploit techniques to further their aims, which is ultimately to make money. In the final analysis, the same advice as always applies for those who want to avoid such attacks. To guard against malware exploiting Microsoft vulnerabilities: To guard against ransomware in general: Finally, there\u2019s the question of whether victims should pay the ransom or stand their ground. Sophos has mostly taken a neutral stance on the issue. In the case of this attack, paying the ransom doesn\u2019t seem to be helping the victims so far. Therefore, Levy believes paying the WannaCry ransom is ill-advised: In general, paying is a bad idea unless the organization is truly desperate to get irreplaceable data back and when it is known that the ransom payment works. In this attack, it doesn\u2019t appear to work.  It\u2019s been referred to as a \u2018kill switch\u2019 \u2013 that all the malware author had to do to throw the breaks on for some reason was to register some obscure domains. In the event a security researcher found the domains and registered them. He speculates that its not actually a kill switch but may be a form of sandbox detection (malware wants to run in the real world and hide when it\u2019s in a researcher\u2019s sandbox.)  The thinking goes that in the kind of sandbox environment used by security researchers the domains might appear to be registered when in fact they are not. If the malware can get a response from the unregistered domains it thinks it\u2019s in a sandbox and shuts down. If you blocklist the domains in your network then you\u2019re turning off the \u201ckill switch\u201d. If you allowlist the domains you\u2019re allowing access to the kill switch.", "sourcefile": "2259.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E1", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 34, "index": "T1", "endOffset": 60, "text": "WannaCry ransomware attack"}, "argument": [{"index": "T2", "text": "Friday", "endOffset": 31, "role": {"type": "Time"}, "startOffset": 25, "type": "Time"}], "subtype": "Ransom"}, {"index": "E2", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 790, "index": "T3", "endOffset": 805, "text": "ransom payments"}, "argument": [{"index": "T4", "text": "weekend", "endOffset": 761, "role": {"type": "Time"}, "startOffset": 754, "type": "Time"}], "subtype": "Ransom"}, {"index": "E3", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 1078, "index": "T5", "endOffset": 1086, "text": "payments"}, "argument": [{"index": "T8", "text": "Saturday", "endOffset": 1016, "role": {"type": "Time"}, "startOffset": 1008, "type": "Time"}, {"index": "T9", "text": "ransomware-associated wallets", "endOffset": 1053, "role": {"type": "Payment-Method"}, "startOffset": 1024, "type": "PaymentMethod"}, {"index": "T6", "external_reference": {"wikidataid": "Q131723"}, "endOffset": 1077, "role": {"type": "Price"}, "text": "92 bitcoin", "startOffset": 1067, "type": "Money"}, {"index": "T7", "external_reference": {"wikidataid": "Q4917"}, "endOffset": 1110, "role": {"type": "Price"}, "text": "$26,407.85 USD", "startOffset": 1096, "type": "Money"}], "subtype": "Ransom"}, {"index": "E4", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 1209, "index": "T10", "endOffset": 1217, "text": "payments"}, "argument": [{"index": "T13", "text": "Monday morning", "endOffset": 1203, "role": {"type": "Time"}, "startOffset": 1189, "type": "Time"}, {"index": "T11", "text": "29.46564365 BTC", "endOffset": 1256, "role": {"type": "Price"}, "startOffset": 1241, "type": "Money"}, {"index": "T12", "external_reference": {"wikidataid": "Q4917"}, "endOffset": 1272, "role": {"type": "Price"}, "text": "$50,504.23 USD", "startOffset": 1258, "type": "Money"}], "subtype": "Ransom"}]}, {"index": 1, "relation": "Same", "events": [{"nugget": {"startOffset": 3544, "index": "T28", "endOffset": 3566, "text": "available for download"}, "index": "E10", "type": "Vulnerability-related", "subtype": "PatchVulnerability", "realis": "Actual"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3344, "index": "T24", "endOffset": 3352, "text": "provided"}, "argument": [{"index": "T22", "text": "the Security Update", "endOffset": 3447, "role": {"type": "Patch"}, "startOffset": 3428, "type": "Patch"}, {"index": "T23", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft", "wikidataid": "Q2283"}, "endOffset": 3339, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 3330, "type": "Organization"}, {"index": "T27", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 3533, "role": {"type": "Vulnerable_System"}, "text": "Windows Server 2003", "startOffset": 3514, "type": "System"}, {"index": "T26", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 3508, "role": {"type": "Vulnerable_System"}, "text": "Windows 8", "startOffset": 3499, "type": "System"}, {"index": "T25", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 3497, "role": {"type": "Vulnerable_System"}, "text": "Windows XP", "startOffset": 3487, "type": "System"}], "subtype": "PatchVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 1907, "index": "T14", "endOffset": 1919, "text": "been patched"}, "argument": [{"index": "T15", "text": "vulnerability", "endOffset": 1890, "role": {"type": "Vulnerability"}, "startOffset": 1877, "type": "Vulnerability"}, {"index": "T16", "text": "the machines", "endOffset": 1781, "role": {"type": "Vulnerable_System"}, "startOffset": 1769, "type": "Device"}], "subtype": "PatchVulnerability"}]}, {"index": 2, "events": [{"nugget": {"startOffset": 4444, "index": "T33", "endOffset": 4470, "text": "paying the WannaCry ransom"}, "index": "E12", "type": "Attack", "subtype": "Ransom", "realis": "Generic"}]}, {"index": 3, "events": [{"index": "E13", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 4499, "index": "T34", "endOffset": 4505, "text": "paying"}, "argument": [{"index": "T35", "external_reference": {"wikidataid": "Q1071976"}, "endOffset": 4543, "role": {"type": "Victim"}, "text": "the organization", "startOffset": 4527, "type": "Organization"}], "subtype": "Ransom"}]}, {"index": 4, "events": [{"index": "E11", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 4354, "index": "T31", "endOffset": 4371, "text": "paying the ransom"}, "argument": [{"index": "T32", "text": "the victims", "endOffset": 4410, "role": {"type": "Victim"}, "startOffset": 4399, "type": "Person"}], "subtype": "Ransom"}]}, {"index": 5, "events": [{"index": "E8", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 4233, "index": "T29", "endOffset": 4247, "text": "pay the ransom"}, "argument": [{"index": "T30", "text": "victims", "endOffset": 4225, "role": {"type": "Victim"}, "startOffset": 4218, "type": "Person"}], "subtype": "Ransom"}]}, {"index": 6, "events": [{"nugget": {"startOffset": 3375, "index": "T21", "endOffset": 3393, "text": "WannaCrypt attacks"}, "index": "E15", "type": "Attack", "subtype": "Ransom", "realis": "Generic"}]}, {"index": 7, "events": [{"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1787, "index": "T17", "endOffset": 1800, "text": "were impacted"}, "argument": [{"index": "T16", "text": "the machines", "endOffset": 1781, "role": {"type": "Vulnerable_System"}, "startOffset": 1769, "type": "Device"}, {"index": "T15", "text": "vulnerability", "endOffset": 1890, "role": {"type": "Vulnerability"}, "startOffset": 1877, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 8, "events": [{"index": "E7", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 2625, "index": "T18", "endOffset": 2636, "text": "was tricked"}, "argument": [{"index": "T20", "text": "a user", "endOffset": 2624, "role": {"type": "Victim"}, "startOffset": 2618, "type": "Person"}, {"index": "T19", "text": "an email", "endOffset": 2587, "role": {"type": "Tool"}, "startOffset": 2579, "type": "File"}, {"index": "T37", "text": "a malicious payload", "endOffset": 2612, "role": {"CAPEC-Meta": "Object Injection", "type": "Attack-Pattern", "confidence": 0.8970713913440704}, "startOffset": 2593, "type": "Capabilities"}, {"index": "T38", "text": "The company", "endOffset": 2529, "role": {"type": "Victim"}, "startOffset": 2518, "type": "Organization"}], "subtype": "Phishing"}]}, {"index": 9, "events": [{"nugget": {"startOffset": 4620, "index": "T36", "endOffset": 4638, "text": "the ransom payment"}, "index": "E14", "type": "Attack", "subtype": "Ransom", "realis": "Generic"}]}]}, "info": {"title": "WannaCry: here\u2019s what we know now about the outbreak \u2013 Naked Security", "date": "2017_05_16", "type": "text", "link": "https://nakedsecurity.sophos.com/2017/05/15/wannacry-heres-what-we-know-now-about-the-outbreak/?utm_source=Naked+Security+-+Sophos+List&utm_campaign=5518daa8fe-naked%252Bsecurity&utm_medium=email&utm_term=0_31623bb782-5518daa8fe-455160889"}}