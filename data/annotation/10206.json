{"content": "Microsoft has released a patch for a critical remote code execution flaw affecting a Windows service used for importing Docker container images. The vulnerability, tracked as CVE-201808115, is due to the Windows Host Compute Service Shim (hcsshim) library not properly validating input from container images while importing them. A remote attacker could execute malware on a Windows host using a malicious Docker container image if they managed to trick an authenticated administrator to import it in Docker for Windows, which uses the hcsshim library. \"An attacker who successfully exploited the vulnerability could execute arbitrary code on the host operating system,\" Microsoft notes in its advisory. The vulnerability hasn't been publicly disclosed.  Anyone using Docker for Windows can resolve the issue today by installing version 0.6.10 of hcsshim. The patch is available from Microsoft's security advisory or from Microsoft's GitHub page. Hcsshim, which is written in Go, is an open-source wrapper that Microsoft developed for use with its Host Compute Service, a container management API in Windows Hyper-V virtualization for Docker. The HCS abstraction layer is Microsoft's way of allowing Docker containers to use Linux kernel features on Windows, such as Linux Namespaces and Control Groups. Hanselmann explains that the flaw stems from hccshim's use of a function from Go and the failure to sanitize input from an imported container image. \"Its use of Go's filepath.Join function with unsanitized input [made it possible] to create, remove and replace files in the host file system, leading to remote code execution,\" he noted. \"Importing a Docker container image or pulling one from a remote registry isn't commonly expected to make modifications to the host file system outside the Docker-internal data structures.\" Separately, Microsoft is reportedly working on a fix for a \"fatal flaw\" in its initial Windows 10 fix for the Meltdown CPU vulnerability. It's been patched in the new Windows 10 April 2018 Update, according to Alex Ionescu, chief architect at Crowdstrike, but hasn't been backported to previous versions of Windows 10.", "sourcefile": "10206.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 788, "index": "T12", "endOffset": 799, "text": "can resolve"}, "argument": [{"index": "T15", "text": "the issue", "endOffset": 809, "role": {"type": "Vulnerability"}, "startOffset": 800, "type": "Vulnerability"}, {"index": "T13", "external_reference": {"wikidataid": "Q15206305"}, "endOffset": 775, "role": {"type": "Vulnerable_System"}, "text": "Docker", "startOffset": 769, "type": "Software"}, {"index": "T19", "text": "today", "endOffset": 815, "role": {"type": "Time"}, "startOffset": 810, "type": "Time"}, {"index": "T14", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 787, "role": {"type": "Supported_Platform"}, "text": "Windows", "startOffset": 780, "type": "System"}], "subtype": "PatchVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 819, "index": "T18", "endOffset": 829, "text": "installing"}, "argument": [{"index": "T16", "text": "version 0.6.10", "endOffset": 844, "role": {"type": "Patch-Number"}, "startOffset": 830, "type": "Version"}, {"index": "T17", "text": "hcsshim", "endOffset": 855, "role": {"type": "Patch"}, "startOffset": 848, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 11, "index": "T1", "endOffset": 23, "text": "has released"}, "argument": [{"index": "T2", "text": "a patch", "endOffset": 31, "role": {"type": "Patch"}, "startOffset": 24, "type": "Patch"}, {"index": "T3", "external_reference": {"wikidataid": "Q2283"}, "endOffset": 10, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 1, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 867, "index": "T20", "endOffset": 879, "text": "is available"}, "argument": [{"index": "T22", "external_reference": {"wikidataid": "Q2283"}, "endOffset": 894, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 885, "type": "Organization"}, {"index": "T21", "text": "The patch", "endOffset": 866, "role": {"type": "Patch"}, "startOffset": 857, "type": "Patch"}, {"index": "T32", "external_reference": {"wikidataid": "Q2283"}, "endOffset": 932, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 923, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1854, "index": "T23", "endOffset": 1875, "text": "is reportedly working"}, "argument": [{"index": "T28", "text": "the Meltdown CPU vulnerability", "endOffset": 1968, "role": {"type": "Vulnerability"}, "startOffset": 1938, "type": "Vulnerability"}, {"index": "T27", "text": "its initial Windows 10 fix", "endOffset": 1933, "role": {"type": "Patch"}, "startOffset": 1907, "type": "Patch"}, {"index": "T26", "text": "a \"fatal flaw\"", "endOffset": 1903, "role": {"type": "Vulnerability"}, "startOffset": 1889, "type": "Vulnerability"}, {"index": "T24", "text": "a fix", "endOffset": 1884, "role": {"type": "Patch"}, "startOffset": 1879, "type": "Patch"}, {"index": "T25", "external_reference": {"wikidataid": "Q2283"}, "endOffset": 1853, "role": {"type": "Releaser"}, "text": "Microsoft", "startOffset": 1844, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1975, "index": "T29", "endOffset": 1987, "text": "been patched"}, "argument": [{"index": "T31", "text": "It", "endOffset": 1972, "role": {"type": "Vulnerability"}, "startOffset": 1970, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 74, "index": "T6", "endOffset": 83, "text": "affecting"}, "argument": [{"index": "T5", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Microsoft_Windows"}, "endOffset": 101, "role": {"type": "Vulnerable_System"}, "text": "a Windows service", "startOffset": 84, "type": "System"}, {"index": "T4", "text": "a critical remote code execution flaw", "endOffset": 73, "role": {"type": "Vulnerability"}, "startOffset": 36, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 165, "index": "T7", "endOffset": 175, "text": "tracked as"}, "argument": [{"index": "T8", "text": "CVE-201808115", "endOffset": 189, "role": {"type": "CVE"}, "startOffset": 176, "type": "CVE"}, {"index": "T9", "text": "The vulnerability", "endOffset": 163, "role": {"type": "Vulnerability"}, "startOffset": 146, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 584, "index": "T30", "endOffset": 593, "text": "exploited"}, "argument": [{"index": "T33", "text": "vulnerability", "endOffset": 611, "role": {"type": "Vulnerability"}, "startOffset": 598, "type": "Vulnerability"}, {"index": "T34", "text": "execute arbitrary code", "endOffset": 640, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9372514188289642}, "startOffset": 618, "type": "Capabilities"}, {"index": "T35", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Operating_system"}, "endOffset": 669, "role": {"type": "Vulnerable_System"}, "text": "host operating system", "startOffset": 648, "type": "System"}, {"index": "T36", "text": "attacker", "endOffset": 566, "role": {"type": "Discoverer"}, "startOffset": 558, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 723, "index": "T10", "endOffset": 753, "text": "hasn't been publicly disclosed"}, "argument": [{"index": "T11", "text": "The vulnerability", "endOffset": 722, "role": {"type": "Vulnerability"}, "startOffset": 705, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "Windows security: Microsoft issues fix for critical Docker tool flaw, so patch now", "date": "2018_05_03", "type": "text", "link": "https://www.zdnet.com/article/windows-security-microsoft-issues-fix-for-critical-docker-tool-flaw-so-patch-now/"}}