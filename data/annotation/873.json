{"content": "A security lapse at content distribution network provider Cloudflare that resulted in customer data being leaked publicly for several months was bad - but had the potential to be much worse. That's Cloudflare's initial postmortem conclusion after a twelve-day review of log data related to the breach. The review showed no evidence that attackers had exploited the flaw prior to it being discovered and patched, Cloudflare CEO and founder Matthew Prince said in a blog Wednesday. A \"vast majority\" of Cloudflare's customers also did not appear to have had any of their data leaked. Cloudflare\u2019s inspection of tens of thousands of pages that were leaked from its reverse-proxy servers and cached by search engines revealed a \"large number\" of instances of internal Cloudflare cookies and headers. But so far, according to Prince, there\u2019s no evidence that passwords, credit card numbers, and other personal data were compromised as was initially feared. The Cloudflare security snafu stemmed from the manner in which a stream parser application that the company uses to modify content passing through its edge servers handled HTTP requests. The bug caused the parser to read memory not only from the HTML page that was being actually parsed, but also from adjacent memory that contained data in response to HTTP requests made by other customers. The flaw was triggered only when pages with certain specific attributes were requested through Cloudflare\u2019s CDN. \"If you had accessed one of the pages that triggered the bug you would have seen what likely looked like random text at the end of the page,\" Prince said. A lot of the leaked data ended up getting cached by search engines and Web scrapers. A security researcher from Google\u2019s Project Zero threat hunting team alerted Cloudfare to the bug last month. The company claimed it fixed the problem in a matter of hours after being notified of the problem. Some have compared the breach to Heartbleed and have even called it Cloudbleed. In his blog, Prince compared the threat posed by the bug to that posed by a stranger eavesdropping on a random conversation between two employees. Most of the time, the stranger would likely hear nothing of value, but occasionally might pick up something confidential. The same would have been true for a malicious attacker, who had somehow known about the bug and exploited it before Cloudflare\u2019s fix, he said. The customers most at risk of having their data exposed were those that sent the most requests through Cloudflare\u2019s CDN. Cloudflare\u2019s detailed postmortem and mea culpa evoked a mixed response from security experts. Ilia Kolochenko, CEO of Web security firm High-Tech Bridge praised Prince\u2019s effort to be transparent about what went down. \"Even if we cannot verify the accuracy of all the numbers inside\u00a0\u2013\u00a0for the moment, I don\u2019t have a valid reason to question either its content, or conclusion,\" Kolochenko says. In fact, until someone can come up with a credible rebuttal of Cloudflare\u2019s internal investigation, it\u2019s inappropriate to compare what happened at the company to Heartbleed. \"I\u2019d say it\u2019s inappropriate even to call this particular incident a 'Cloudbleed,'\" he says. \"In the Heartbleed case, almost every company in the world, many software vendors including cybersecurity companies, were seriously impacted by the vulnerability.\" Heartbleed also resulted in multiple breaches and many organizations continue to be exposed to the threat. Neither of those situations applies to the Cloudflare security lapse. \"All avenues of\u00a0Cloudflare\u2019s vulnerability exploitation seems to be mitigated by now,\" he says. But Kunal Anand, CTO of application security vendor Prevoty, says the details Cloudflare has shared aren't exactly reassuring. If no sensitive information like credit numbers and Social Security Numbers were leaked and the leaked dataset itself was relatively small, there is no reason why Cloudflare shouldn't share it with a third-party for an unbiased review, he says. \"CloudFlare needs to realize that HTTP headers, including cookies, contain sensitive information like session identifiers, authorization tokens and IP addresses,\" Anand says. \"All of these data points should count as private data.\" CloudFlare has been working with various search engines to purge their caches, but in the process, any evidence of the data that was leaked is being deleted as well. That makes it hard to quantify the scope of the data breach outside of CloudFlare's own logs. \"There's a lot of speculation if nation-state sponsored engines will actually purge the data or copy it for further analysis,\" Anand says.", "sourcefile": "873.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2327, "index": "T31", "endOffset": 2338, "text": "known about"}, "argument": [{"index": "T32", "text": "the bug", "endOffset": 2346, "role": {"type": "Vulnerability"}, "startOffset": 2339, "type": "Vulnerability"}, {"index": "T30", "text": "a malicious attacker", "endOffset": 2309, "role": {"type": "Discoverer"}, "startOffset": 2289, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E20", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2351, "index": "T54", "endOffset": 2360, "text": "exploited"}, "argument": [{"index": "T55", "text": "it", "endOffset": 2363, "role": {"type": "Vulnerability"}, "startOffset": 2361, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1881, "index": "T25", "endOffset": 1889, "text": "notified"}, "argument": [{"index": "T26", "text": "the problem", "endOffset": 1904, "role": {"type": "Vulnerability"}, "startOffset": 1893, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E21", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 351, "index": "T56", "endOffset": 360, "text": "exploited"}, "argument": [{"index": "T9", "text": "the flaw", "endOffset": 369, "role": {"type": "Vulnerability"}, "startOffset": 361, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 382, "index": "T7", "endOffset": 398, "text": "being discovered"}, "argument": [{"index": "T57", "text": "it", "endOffset": 381, "role": {"type": "Vulnerability"}, "startOffset": 379, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1766, "index": "T16", "endOffset": 1773, "text": "alerted"}, "argument": [{"index": "T20", "text": "A security researcher", "endOffset": 1718, "role": {"type": "Discoverer"}, "startOffset": 1697, "type": "Person"}, {"index": "T17", "text": "Cloudfare", "endOffset": 1783, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 1774, "type": "Organization"}, {"index": "T18", "text": "the bug", "endOffset": 1794, "role": {"type": "Vulnerability"}, "startOffset": 1787, "type": "Vulnerability"}, {"index": "T19", "text": "last month", "endOffset": 1805, "role": {"type": "Time"}, "startOffset": 1795, "type": "Time"}, {"index": "T49", "text": "Project Zero threat hunting team", "endOffset": 1765, "role": {"type": "Discoverer"}, "startOffset": 1733, "type": "Person"}, {"index": "T48", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Google", "wikidataid": "Q95"}, "endOffset": 1731, "role": {"type": "Discoverer"}, "text": "Google\u2019", "startOffset": 1724, "type": "Organization"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "relation": "Same", "events": [{"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1830, "index": "T23", "endOffset": 1835, "text": "fixed"}, "argument": [{"index": "T24", "text": "the problem", "endOffset": 1847, "role": {"type": "Vulnerability"}, "startOffset": 1836, "type": "Vulnerability"}, {"index": "T22", "external_reference": {"wikidataid": "Q38"}, "endOffset": 1829, "role": {"type": "Releaser"}, "text": "it", "startOffset": 1827, "type": "Organization"}, {"index": "T21", "text": "The company", "endOffset": 1818, "role": {"type": "Releaser"}, "startOffset": 1807, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2384, "index": "T33", "endOffset": 2387, "text": "fix"}, "argument": [{"index": "T50", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Cloudflare", "wikidataid": "Q4778915"}, "endOffset": 2381, "role": {"type": "Releaser"}, "text": "Cloudflare", "startOffset": 2371, "type": "Organization"}], "subtype": "PatchVulnerability"}, {"nugget": {"startOffset": 403, "index": "T8", "endOffset": 410, "text": "patched"}, "index": "E4", "type": "Vulnerability-related", "subtype": "PatchVulnerability", "realis": "Generic"}, {"index": "E19", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 3587, "index": "T53", "endOffset": 3596, "text": "mitigated"}, "argument": [{"index": "T52", "text": "vulnerability", "endOffset": 3561, "role": {"type": "Vulnerability"}, "startOffset": 3548, "type": "Vulnerability"}, {"index": "T51", "text": "Cloudflare", "endOffset": 3545, "role": {"type": "Vulnerable_System"}, "startOffset": 3535, "type": "System"}], "subtype": "PatchVulnerability"}]}, {"index": 3, "relation": "Same", "events": [{"index": "E15", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 3370, "index": "T39", "endOffset": 3387, "text": "multiple breaches"}, "argument": [{"index": "T38", "text": "many organizations", "endOffset": 3410, "role": {"type": "Victim"}, "startOffset": 3392, "type": "Organization"}], "subtype": "Databreach"}, {"nugget": {"startOffset": 3423, "index": "T37", "endOffset": 3433, "text": "be exposed"}, "index": "E14", "type": "Attack", "subtype": "Databreach", "realis": "Actual"}, {"index": "E1", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 100, "index": "T3", "endOffset": 112, "text": "being leaked"}, "argument": [{"index": "T4", "text": "several months", "endOffset": 140, "role": {"type": "Time"}, "startOffset": 126, "type": "Time"}, {"index": "T2", "text": "customer data", "endOffset": 99, "role": {"type": "Compromised-Data"}, "startOffset": 86, "type": "PII"}, {"index": "T1", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Cloudflare", "wikidataid": "Q4778915"}, "endOffset": 68, "role": {"type": "Victim"}, "text": "network provider Cloudflare", "startOffset": 41, "type": "Organization"}], "subtype": "Databreach"}, {"index": "E2", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 290, "index": "T6", "endOffset": 300, "text": "the breach"}, "argument": [{"index": "T5", "text": "log data", "endOffset": 278, "role": {"type": "Compromised-Data"}, "startOffset": 270, "type": "Data"}], "subtype": "Databreach"}, {"index": "E5", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 563, "index": "T10", "endOffset": 580, "text": "their data leaked"}, "argument": [{"index": "T11", "text": "customers", "endOffset": 523, "role": {"type": "Victim"}, "startOffset": 514, "type": "Person"}, {"index": "T47", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Cloudflare", "wikidataid": "Q4778915"}, "endOffset": 511, "role": {"type": "Victim"}, "text": "Cloudflare", "startOffset": 501, "type": "Organization"}], "subtype": "Databreach"}, {"index": "E6", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 641, "index": "T13", "endOffset": 652, "text": "were leaked"}, "argument": [{"index": "T12", "text": "pages", "endOffset": 635, "role": {"type": "Victim"}, "startOffset": 630, "type": "Website"}, {"index": "T14", "text": "tens of thousands", "endOffset": 626, "role": {"type": "Number-of-Victim"}, "startOffset": 609, "type": "Number"}, {"index": "T15", "text": "its reverse-proxy servers", "endOffset": 683, "role": {"type": "Victim"}, "startOffset": 658, "type": "System"}], "subtype": "Databreach"}, {"index": "E13", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 2446, "index": "T35", "endOffset": 2453, "text": "exposed"}, "argument": [{"index": "T34", "text": "their data", "endOffset": 2445, "role": {"type": "Compromised-Data"}, "startOffset": 2435, "type": "Data"}, {"index": "T36", "text": "The customers", "endOffset": 2411, "role": {"type": "Victim"}, "startOffset": 2398, "type": "Person"}], "subtype": "Databreach"}, {"index": "E16", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 3818, "index": "T40", "endOffset": 3829, "text": "were leaked"}, "argument": [{"index": "T41", "text": "Social Security Numbers", "endOffset": 3817, "role": {"type": "Compromised-Data"}, "startOffset": 3794, "type": "PII"}, {"index": "T42", "text": "credit numbers", "endOffset": 3789, "role": {"type": "Compromised-Data"}, "startOffset": 3775, "type": "PII"}, {"index": "T43", "text": "sensitive information", "endOffset": 3769, "role": {"type": "Compromised-Data"}, "startOffset": 3748, "type": "Data"}], "subtype": "Databreach"}, {"index": "E17", "type": "Attack", "realis": "Other", "nugget": {"startOffset": 4348, "index": "T44", "endOffset": 4358, "text": "was leaked"}, "argument": [{"index": "T45", "text": "the data", "endOffset": 4342, "role": {"type": "Compromised-Data"}, "startOffset": 4334, "type": "Data"}], "subtype": "Databreach"}, {"nugget": {"startOffset": 4429, "index": "T46", "endOffset": 4444, "text": "the data breach"}, "index": "E18", "type": "Attack", "subtype": "Databreach", "realis": "Actual"}]}, {"index": 4, "events": [{"index": "E10", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 2223, "index": "T28", "endOffset": 2230, "text": "pick up"}, "argument": [{"index": "T29", "text": "something confidential", "endOffset": 2253, "role": {"type": "Compromised-Data"}, "startOffset": 2231, "type": "Data"}, {"index": "T27", "text": "the stranger", "endOffset": 2163, "role": {"type": "Attacker"}, "startOffset": 2151, "type": "Person"}], "subtype": "Databreach"}]}]}, "info": {"title": "Cloudflare Breach Had Potential To Be Much Worse", "date": "2017_03_03", "type": "text", "link": "http://www.darkreading.com/attacks-breaches/cloudflare-breach-had-potential-to-be-much-worse/d/d-id/1328308?"}}