{"content": "A decade ago, cross-site request forgery (CSRF, often pronounced \u201cc-surf\u201d) was considered to be a sleeping giant, preparing to wake and inflict havoc on the Worldwide Web. But the doomsday scenario never materialized and you don\u2019t even seem to hear much about it anymore. In this blog post, part 1 of 2, I will explore this idea and try to understand why the CSRF giant never awoke. First we\u2019ll cover the overall threat landscape, trends, and some notable CSRF exploits throughout the years, including one from personal experience. As a quick review, CSRF exists because web applications trust the cookies sent by web browsers within an HTTP request. In a CSRF attack, the attacker causes a victim\u2019s browser to make a request that results in a change or action which benefits the attacker (and/or harms the victim) in some way. Without a specific defense \u2013 like a random token in the request body that is validated on the server side \u2013 CSRF attacks are possible. After a bit of testing, my suspicions were confirmed. All requests that caused any sort of change could be exploited with CSRF. This included: I contacted the company to let them know about these security holes. Surprisingly, they didn\u2019t seem to be aware there was such a thing as CSRF, but they thanked me anyway and rolled out a fix about a month later. There have been other notable instances of CSRF vulnerabilities with some of them being exploited in the wild. Drive-by pharming is an attack on the DNS settings of home routers and modems and often leverages CSRF as a key element. The web UIs on these devices are the culprit, because they allow users to edit configuration settings. In one attack from 2008, banking customers in Mexico who owned 2Wire DSL modems were targeted. Victims received an email with an embedded image tag with a CSRF attack that changed the DNS settings on their modem. In another instance, tens of thousands of Twitter users fell victim to a CSRF worm in 2010 when developers failed to implement anti-CSRF measures for tweets. The vulnerability was discovered and exploited in a rather distasteful but harmless way. When authenticated Twitter users visited the web page containing the exploit, they unknowingly posted two tweets \u2013 one with a link to the same page and another with a message about goats. Anyone who clicked on the link in the first tweet also posted the same two tweets. The worm spread like wildfire before it was fixed by Twitter. In 2012 Facebook\u2019s App Center was vulnerable to CSRF and the security researcher who discovered the flaw was awarded $5000 as a bounty. Interestingly, in this case the HTTP request included an anti-CSRF token that appeared at first glance to provide protection, but the token was not being validated by the server-side application when the request was received. A Qualys researcher found other examples where anti-CSRF tokens were not properly validated. And similar to the Facebook issue mentioned above, PayPal in 2016 did not validate the anti-CSRF token in paypal.me. An attacker could only change a user\u2019s profile photo in that case however.", "sourcefile": "390.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2043, "index": "T10", "endOffset": 2057, "text": "was discovered"}, "argument": [{"index": "T11", "text": "The vulnerability", "endOffset": 2042, "role": {"type": "Vulnerability"}, "startOffset": 2025, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"nugget": {"startOffset": 2062, "index": "T17", "endOffset": 2071, "text": "exploited"}, "index": "E5", "type": "Vulnerability-related", "subtype": "DiscoverVulnerability", "realis": "Actual"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1133, "index": "T3", "endOffset": 1146, "text": "let them know"}, "argument": [{"index": "T1", "text": "security holes", "endOffset": 1173, "role": {"type": "Vulnerability"}, "startOffset": 1159, "type": "Vulnerability"}, {"index": "T2", "text": "I", "endOffset": 1107, "role": {"type": "Discoverer"}, "startOffset": 1106, "type": "Person"}, {"index": "T4", "text": "the company", "endOffset": 1129, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 1118, "type": "Organization"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1401, "index": "T18", "endOffset": 1416, "text": "being exploited"}, "argument": [{"index": "T19", "text": "CSRF vulnerabilities", "endOffset": 1382, "role": {"type": "Vulnerability"}, "startOffset": 1362, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2477, "index": "T12", "endOffset": 2491, "text": "was vulnerable"}, "argument": [{"index": "T15", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Facebook", "wikidataid": "Q355"}, "endOffset": 2463, "role": {"type": "Vulnerable_System_Owner"}, "text": "Facebook", "startOffset": 2455, "type": "Organization"}, {"index": "T20", "text": "CSRF", "endOffset": 2499, "role": {"CAPEC-Meta": "Malicious Logic Insertion", "type": "Capabilities", "confidence": 0.8159084618091583}, "startOffset": 2495, "type": "Capabilities"}, {"index": "T16", "text": "2012", "endOffset": 2454, "role": {"type": "Time"}, "startOffset": 2450, "type": "Time"}, {"index": "T8", "text": "App Center", "endOffset": 2476, "role": {"type": "Vulnerable_System"}, "startOffset": 2466, "type": "System"}], "subtype": "DiscoverVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2532, "index": "T9", "endOffset": 2542, "text": "discovered"}, "argument": [{"index": "T14", "text": "the security researcher", "endOffset": 2527, "role": {"type": "Discoverer"}, "startOffset": 2504, "type": "Person"}, {"index": "T13", "text": "the flaw", "endOffset": 2551, "role": {"type": "Vulnerability"}, "startOffset": 2543, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1281, "index": "T5", "endOffset": 1291, "text": "rolled out"}, "argument": [{"index": "T6", "text": "they", "endOffset": 1258, "role": {"type": "Releaser"}, "startOffset": 1254, "type": "Organization"}, {"index": "T7", "text": "a month later", "endOffset": 1317, "role": {"type": "Time"}, "startOffset": 1304, "type": "Time"}, {"index": "T21", "text": "a fix", "endOffset": 1297, "role": {"type": "Patch"}, "startOffset": 1292, "type": "Patch"}], "subtype": "PatchVulnerability"}]}]}, "info": {"title": "Cross-Site Request Forgery: What Happened to the Sleeping Giant? | Qualys Blog", "date": "2017_01_27", "type": "text", "link": "https://blog.qualys.com/webappsec/2017/01/26/cross-site-request-forgery-what-happened-to-the-sleeping-giant?utm_source=hs_email&utm_medium=email&utm_content=41461127&_hsenc=p2ANqtz-_Qn5IiQe3EOVNZzqIQmCYmKWtmM_wGHeXqIlyhACmkasYfrEgh-dQvcPqo8WB6rF9eZty0O1FDXvL-T8H7YcVP-eF-AA&_hsmi=41461127"}}