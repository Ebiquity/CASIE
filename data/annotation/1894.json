{"content": "Users of open source webmail software SquirrelMail are open to remote code execution due to a bug (CVE-2017-7692) discovered independently by two researchers. \u201cIf the target server uses Sendmail and SquirrelMail is configured to use it as a command-line program, it\u2019s possible to trick sendmail into using an attacker-provided configuration file that triggers the execution of an arbitrary command,\u201d the explanation provided by MITRE reads.  \u201cFor exploitation, the attacker must upload a sendmail.cf file as an email attachment, and inject the sendmail.cf filename with the -C option within the \u2018Options > Personal Informations > Email Address\u2019 setting.\u201d The bug was found by researchers Filippo Cavallarin and Dawid Golunski, independently of one another, and affects SquirrelMail versions 1.4.22 and below.  Golunski reported it to SquirrelMail (sole) developer Paul Lesniewski, who asked for a delay of publication of the details until he could fix the flaw. But as Cavallarin published details about it last week (after not receiving any reply by the SquirrelMail developer), Golunski did the same during the weekend. Both researchers provided a proof-of-concept exploit for the flaw, and Cavallarin even offered an unofficial patch for plugging the hole. All this prompted Lesniewski to push out a patch on Monday, and new, patched version snapshots of the software (1.4.23-svn and 1.5.2-svn). He also told The Register that exploitation of the bug is difficult to pull off. \u201cIn order to exploit the bug, a malicious user would need to have already gained control over a mail account by other means, SquirrelMail would need to be configured to allow users to change their outgoing email address (we recommend keeping this disabled), the user would need to determine the location of the attachments directory (by gaining shell access or making guesses), the permissions on said directory and files would need to allow access by other processes (by default this will usually be the case, but prudent admins will exert more stringent access controls) and of course, SquirrelMail needs to be configured to send via Sendmail and not SMTP (default is SMTP),\u201d he explained. Still, according to Golunski, the 1.4.23 version snapshot offered on Monday was still vulnerable. But another one was pushed out today, so it\u2019s possible that the issue was finally, definitely fixed. Users can wait to update their installation until things become more clear, and in the meantime, they can protect themselves by configuring their systems not to use Sendmail.", "sourcefile": "1894.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E12", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2353, "index": "T43", "endOffset": 2369, "text": "definitely fixed"}, "argument": [{"index": "T42", "text": "the issue", "endOffset": 2339, "role": {"type": "Vulnerability"}, "startOffset": 2330, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E13", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2286, "index": "T44", "endOffset": 2300, "text": "was pushed out"}, "argument": [{"index": "T45", "text": "another one", "endOffset": 2285, "role": {"type": "Patch"}, "startOffset": 2274, "type": "Patch"}, {"index": "T46", "text": "today", "endOffset": 2306, "role": {"type": "Time"}, "startOffset": 2301, "type": "Time"}], "subtype": "PatchVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2230, "index": "T38", "endOffset": 2237, "text": "offered"}, "argument": [{"index": "T37", "text": "the 1.4.23 version snapshot", "endOffset": 2229, "role": {"type": "Patch-Number"}, "startOffset": 2202, "type": "Version"}, {"index": "T39", "text": "Monday", "endOffset": 2247, "role": {"type": "Time"}, "startOffset": 2241, "type": "Time"}], "subtype": "PatchVulnerability"}, {"index": "E6", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1209, "index": "T21", "endOffset": 1216, "text": "offered"}, "argument": [{"index": "T22", "text": "an unofficial patch", "endOffset": 1236, "role": {"type": "Patch"}, "startOffset": 1217, "type": "Patch"}, {"index": "T25", "text": "Cavallarin", "endOffset": 1203, "role": {"type": "Releaser"}, "startOffset": 1193, "type": "Person"}], "subtype": "PatchVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1241, "index": "T23", "endOffset": 1249, "text": "plugging"}, "argument": [{"index": "T24", "text": "the hole", "endOffset": 1258, "role": {"type": "Vulnerability"}, "startOffset": 1250, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 942, "index": "T13", "endOffset": 951, "text": "could fix"}, "argument": [{"index": "T14", "text": "he", "endOffset": 941, "role": {"type": "Releaser"}, "startOffset": 939, "type": "Person"}, {"index": "T15", "text": "the flaw", "endOffset": 960, "role": {"type": "Vulnerability"}, "startOffset": 952, "type": "Vulnerability"}], "subtype": "PatchVulnerability"}, {"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1292, "index": "T29", "endOffset": 1300, "text": "push out"}, "argument": [{"index": "T32", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Stanis\u0142aw_Le\u015bniewski", "wikidataid": "Q528493"}, "endOffset": 1288, "role": {"type": "Releaser"}, "text": "Lesniewski", "startOffset": 1278, "type": "Person"}, {"index": "T30", "text": "a patch", "endOffset": 1308, "role": {"type": "Patch"}, "startOffset": 1301, "type": "Patch"}, {"index": "T31", "text": "Monday", "endOffset": 1318, "role": {"type": "Time"}, "startOffset": 1312, "type": "Time"}, {"index": "T34", "text": "1.5.2-svn", "endOffset": 1396, "role": {"type": "Patch-Number"}, "startOffset": 1387, "type": "Version"}, {"index": "T33", "text": "1.4.23-svn", "endOffset": 1382, "role": {"type": "Patch-Number"}, "startOffset": 1372, "type": "Version"}, {"index": "T36", "text": "the software", "endOffset": 1370, "role": {"type": "Vulnerable_System"}, "startOffset": 1358, "type": "Software"}, {"index": "T35", "text": "patched version snapshots", "endOffset": 1354, "role": {"type": "Patch-Number"}, "startOffset": 1329, "type": "Version"}], "subtype": "PatchVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 114, "index": "T1", "endOffset": 124, "text": "discovered"}, "argument": [{"index": "T4", "text": "a bug", "endOffset": 97, "role": {"type": "Vulnerability"}, "startOffset": 92, "type": "Vulnerability"}, {"index": "T3", "text": "CVE-2017-7692", "endOffset": 112, "role": {"type": "CVE"}, "startOffset": 99, "type": "CVE"}, {"index": "T2", "text": "two researchers", "endOffset": 157, "role": {"type": "Discoverer"}, "startOffset": 142, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 663, "index": "T6", "endOffset": 672, "text": "was found"}, "argument": [{"index": "T7", "text": "researchers Filippo Cavallarin", "endOffset": 706, "role": {"type": "Discoverer"}, "startOffset": 676, "type": "Person"}, {"index": "T8", "text": "Dawid Golunski", "endOffset": 725, "role": {"type": "Discoverer"}, "startOffset": 711, "type": "Person"}, {"index": "T5", "text": "The bug", "endOffset": 662, "role": {"type": "Vulnerability"}, "startOffset": 655, "type": "Vulnerability"}, {"index": "T9", "external_reference": {"wikidataid": "Q1752969"}, "endOffset": 781, "role": {"type": "Vulnerable_System"}, "text": "SquirrelMail", "startOffset": 769, "type": "Software"}, {"index": "T47", "text": "versions 1.4.22", "endOffset": 797, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 782, "type": "Version"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 819, "index": "T10", "endOffset": 827, "text": "reported"}, "argument": [{"index": "T11", "text": "it", "endOffset": 830, "role": {"type": "Vulnerability"}, "startOffset": 828, "type": "Vulnerability"}, {"index": "T12", "text": "SquirrelMail (sole) developer Paul Lesniewski", "endOffset": 879, "role": {"type": "Vulnerable_System_Owner"}, "startOffset": 834, "type": "Person"}, {"index": "T16", "text": "Golunski", "endOffset": 818, "role": {"type": "Discoverer"}, "startOffset": 810, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 980, "index": "T18", "endOffset": 989, "text": "published"}, "argument": [{"index": "T20", "text": "it", "endOffset": 1006, "role": {"type": "Vulnerability"}, "startOffset": 1004, "type": "Vulnerability"}, {"index": "T17", "text": "last week", "endOffset": 1016, "role": {"type": "Time"}, "startOffset": 1007, "type": "Time"}, {"index": "T19", "text": "Cavallarin", "endOffset": 979, "role": {"type": "Discoverer"}, "startOffset": 969, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1139, "index": "T28", "endOffset": 1147, "text": "provided"}, "argument": [{"index": "T26", "text": "Both researchers", "endOffset": 1138, "role": {"type": "Discoverer"}, "startOffset": 1122, "type": "Person"}, {"index": "T27", "text": "the flaw", "endOffset": 1187, "role": {"type": "Vulnerability"}, "startOffset": 1179, "type": "Vulnerability"}, {"index": "T48", "text": "proof-of-concept exploit", "endOffset": 1174, "role": {"type": "Vulnerability"}, "startOffset": 1150, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 2, "events": [{"index": "E11", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 2248, "index": "T40", "endOffset": 2268, "text": "was still vulnerable"}, "argument": [{"index": "T41", "text": "Golunski", "endOffset": 2200, "role": {"type": "Discoverer"}, "startOffset": 2192, "type": "Person"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "SquirrelMail opens users to remote code execution - Help Net Security", "date": "2017_04_26", "type": "text", "link": "https://www.helpnetsecurity.com/2017/04/25/squirrelmail-remote-code-execution/"}}