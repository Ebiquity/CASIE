{"content": "In an attack predicted by cyber security experts for months, a yet unknown actor or actors integrated the EQUATIONGROUP APT exploits leaked by ShadowBrokers in a worldwide ransomware worm attack, infecting tens of thousands of endpoints in a matter of hours. On Friday, May 12, a new ransomware, called WannaCry, began circulating throughout the United Kingdom and Spain, rapidly infecting over 45,000 exposed servers at healthcare, financial, and other business sectors. This ransomware stood out for several reasons, including being the largest ransomware attack in history, and the first widely spread ransomware worm. The ransomware infection is Version 2.0 of WanaCypt0r (also known as WCry, WannaCry, and WannaCryptor). Unlike previous instances, this version takes advantage of the SMB vulnerability outlined in Microsoft Security Bulletin (MS17-010). This vulnerability was first exploited by the ETERNALBLUE malware, revealed by the ShadowBrokers leak in March, and targeted the Microsoft MS17-010 SMB vulnerabilities. SMB (Server Message Block) is a protocol primarily communicating on port 445 and is designed to provide access to shared resources on a network. Last fall, Microsoft propounded system administrators to disable SMB Version 1 on systems. According to a FBI FLASH Alert (TLP:White) received by Recorded Future, the WannaCry ransomware infects initial endpoints via a phishing campaign or compromised RDP (remote desktop protocol). Once the ransomware gets into a network, it spreads quickly through any computers that don\u2019t have the patch applied. The worm-like capabilities are the new feature added to this ransomware. During the May 12 attack, two of the most significant targets were Telefonica, the Spanish telecommunications giant, and the United Kingdom\u2019s National Health Service. In the United States, the shipping firm FedEx was hit by the ransomware. Infections of the new version of WannaCry started in Spain early on May 12, but quickly spread to the United Kingdom, Russia, Japan, Taiwan, the United States, and many more. In total, almost 100 countries were affected by the attack. New instances of this ransomware worm dramatically decreased following the activation of a \u201ckill-switch\u201d in the ransomware. A security researcher going by the Twitter handle @MalwareTechBlog noted an unregistered domain (www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com) in a sample of the malware. WannaCry checked to ensure non-registration of the domain at some point prior to infection. According to the researcher, this was likely intended as a way to prevent analysis of the malware in a sandbox. If the domain is registered, WannaCry exits the system, preventing further infection. While this doesn\u2019t benefit victims already infected, it does curb further infection. Additionally, according to security researcher Didier Stevens, WannaCry isn\u2019t proxy aware, so enterprises utilizing a proxy won\u2019t benefit from the \u201ckill-switch.\u201d Spora ransomware, which began circulating in January of this year, is a ransomware noted for its sophistication, including top-notch customer support to victims, and was likely created by professional malicious actors. Research in Recorded Future identified an early warning bulletin on WannaCry published on May 5, 2017 by the Spanish CERTSI (Computer Emergency Response Team for Security and Industry). The CERTSI bulletin cited numerous ransomware attacks using WannaCry targeting on equipment. It appears Russian cyber criminals were equally perplexed by the WCry campaign as the rest of the world. One of the members of the popular underground community complained about the recently purchased Virtual Private Server (VPS) which was almost immediately infected by ransomware even before the system update was completed. At least three separate Bitcoin wallets, controlled by unknown criminals were identified as part of the ransomware campaign. As of this writing, little over 15 Bitcoins or approximately $26,000 were deposited to wallets controlled by unknown criminals. In the Reference section of the WCry Intel Card, we see this factsheet posted towards a GitHub page where security researcher Mark Lee helpfully wrote a running compilation of information on WannaCry ransomware. Early identification of these types of resources during an evolving situation can greatly assist a security analyst gain insight to the nature of the threat and crowdsource solutions.", "sourcefile": "2258.txt", "cyberevent": {"hopper": [{"index": 0, "events": [{"index": "E2", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 547, "index": "T5", "endOffset": 564, "text": "ransomware attack"}, "argument": [{"index": "T6", "text": "spread ransomware worm", "endOffset": 620, "role": {"CAPEC-Meta": "Flooding", "type": "Attack-Pattern", "confidence": 0.8563750386238098}, "startOffset": 598, "type": "Capabilities"}], "subtype": "Ransom"}]}, {"index": 1, "events": [{"index": "E1", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 172, "index": "T1", "endOffset": 194, "text": "ransomware worm attack"}, "argument": [{"index": "T2", "text": "unknown actor", "endOffset": 80, "role": {"type": "Attacker"}, "startOffset": 67, "type": "Person"}, {"index": "T3", "text": "the EQUATIONGROUP APT", "endOffset": 123, "role": {"type": "Attacker"}, "startOffset": 102, "type": "Organization"}, {"index": "T4", "text": "exploits leaked by ShadowBrokers", "endOffset": 156, "role": {"CAPEC-Meta": "Interception", "type": "Attack-Pattern", "confidence": 0.8897421956062317}, "startOffset": 124, "type": "Capabilities"}, {"index": "T10", "text": "actors", "endOffset": 90, "role": {"type": "Attacker"}, "startOffset": 84, "type": "Person"}, {"index": "T16", "text": "infecting tens of thousands of endpoints", "endOffset": 236, "role": {"CAPEC-Meta": "Flooding", "type": "Attack-Pattern", "confidence": 0.8941344022750854}, "startOffset": 196, "type": "Capabilities"}], "subtype": "Ransom"}]}, {"index": 2, "events": [{"nugget": {"startOffset": 926, "index": "T17", "endOffset": 934, "text": "revealed"}, "index": "E6", "type": "Vulnerability-related", "subtype": "DiscoverVulnerability", "realis": "Generic"}]}, {"index": 3, "events": [{"index": "E3", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 3400, "index": "T7", "endOffset": 3418, "text": "ransomware attacks"}, "argument": [{"index": "T9", "text": "equipment", "endOffset": 3456, "role": {"type": "Victim"}, "startOffset": 3447, "type": "Device"}, {"index": "T8", "external_reference": {"wikidataid": "Q29908721"}, "endOffset": 3433, "role": {"type": "Tool"}, "text": "WannaCry", "startOffset": 3425, "type": "Malware"}], "subtype": "Ransom"}]}, {"index": 4, "events": [{"nugget": {"startOffset": 938, "index": "T18", "endOffset": 960, "text": "the ShadowBrokers leak"}, "index": "E7", "type": "Attack", "subtype": "Databreach", "realis": "Generic"}]}, {"index": 5, "events": [{"index": "E4", "type": "Attack", "realis": "Generic", "nugget": {"startOffset": 3523, "index": "T12", "endOffset": 3536, "text": "WCry campaign"}, "argument": [{"index": "T11", "text": "Russian cyber criminals", "endOffset": 3492, "role": {"type": "Attacker"}, "startOffset": 3469, "type": "Person"}], "subtype": "Ransom"}]}, {"index": 6, "events": [{"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 888, "index": "T13", "endOffset": 897, "text": "exploited"}, "argument": [{"index": "T14", "text": "vulnerability", "endOffset": 877, "role": {"type": "Vulnerability"}, "startOffset": 864, "type": "Vulnerability"}, {"index": "T15", "text": "SMB vulnerabilities", "endOffset": 1026, "role": {"type": "Vulnerability"}, "startOffset": 1007, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}]}, "info": {"title": "What Is WannaCry? Analyzing the Global Ransomware Attack", "date": "2017_05_16", "type": "text", "link": "https://www.recordedfuture.com/wannacry-ransomware-analysis/"}}