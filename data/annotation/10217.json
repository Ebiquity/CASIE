{"content": "Valve has patched a critical vulnerability in the Steam client which has lurked undetected for at least 10 years. The vulnerability impacts all versions of the gaming platform. Tom Court, a security researcher hailing from Context Information Security, discovered the bug and disclosed his findings on Thursday. In a blog post, the researcher said that left unpatched, the bug permits threat actors to perform remote code execution (RCE) attacks. It was not until July last year that Valve added modern ASLR exploit protections to its Steam source code. However, this addition made sure that the vulnerability would only cause a client crash if exploited -- unless a separate information leak vulnerability was also active in the exploit chain.  Valve's Steam software uses a custom protocol, known as the \"Steam Protocol,\" which is delivered on the top of UDP. The protocol registers packet length and the total reassembled datagram length; however, the vulnerability was caused by a simple lack of checks to ensure that for the first packet of a fragmented datagram, the specified length was less than or equal to the total datagram length. All an attacker needed to do was to send a malformed UDP packet to trigger the exploit. \"This means that it is possible to supply a data_len smaller than packet_len and have up to 64kb of data (due to the 2-byte width of the packet_len field) copied to a very small buffer, resulting in an exploitable heap corruption,\" Court says. \"This seems like a simple oversight, given that the check was present for all subsequent packets carrying fragments of the datagram.\" The vulnerability was reported to Valve on 20 February and was fixed in a beta release less than 12 hours later. This patch was then pushed to a stable release on 22 March. \"This was a very simple bug, made relatively straightforward to exploit due to a lack of modern exploit protections,\" Court says. \"The vulnerable code was probably very old, but as it was otherwise in good working order, the developers likely saw no reason to go near it or update their build scripts.\" \"The lesson here is that as a developer it is important to periodically include aging code and build systems in your reviews to ensure they conform to modern security standards, even if the actual functionality of the code has remained unchanged,\" the researcher added.", "sourcefile": "10217.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E2", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 132, "index": "T5", "endOffset": 139, "text": "impacts"}, "argument": [{"index": "T8", "text": "The vulnerability", "endOffset": 131, "role": {"type": "Vulnerability"}, "startOffset": 114, "type": "Vulnerability"}, {"index": "T6", "text": "the gaming platform", "endOffset": 175, "role": {"type": "Vulnerable_System"}, "startOffset": 156, "type": "System"}, {"index": "T7", "text": "all versions", "endOffset": 152, "role": {"type": "Vulnerable_System_Version"}, "startOffset": 140, "type": "Version"}], "subtype": "DiscoverVulnerability"}, {"index": "E3", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 253, "index": "T10", "endOffset": 263, "text": "discovered"}, "argument": [{"index": "T15", "text": "Context Information Security", "endOffset": 251, "role": {"type": "Discoverer"}, "startOffset": 223, "type": "Organization"}, {"index": "T9", "text": "a security researcher", "endOffset": 209, "role": {"type": "Discoverer"}, "startOffset": 188, "type": "Person"}, {"index": "T16", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/Tom_Court", "wikidataid": "Q3530696"}, "endOffset": 186, "role": {"type": "Discoverer"}, "text": "Tom Court", "startOffset": 177, "type": "Person"}], "subtype": "DiscoverVulnerability"}, {"index": "E4", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 276, "index": "T12", "endOffset": 285, "text": "disclosed"}, "argument": [{"index": "T11", "text": "the bug", "endOffset": 271, "role": {"type": "Vulnerability"}, "startOffset": 264, "type": "Vulnerability"}, {"index": "T13", "text": "his findings", "endOffset": 298, "role": {"type": "Vulnerability"}, "startOffset": 286, "type": "Vulnerability"}, {"index": "T14", "text": "Thursday", "endOffset": 310, "role": {"type": "Time"}, "startOffset": 302, "type": "Time"}], "subtype": "DiscoverVulnerability"}, {"index": "E5", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 343, "index": "T18", "endOffset": 347, "text": "said"}, "argument": [{"index": "T20", "text": "the bug", "endOffset": 376, "role": {"type": "Vulnerability"}, "startOffset": 369, "type": "Vulnerability"}, {"index": "T19", "text": "the researcher", "endOffset": 342, "role": {"type": "Discoverer"}, "startOffset": 328, "type": "Person"}, {"index": "T17", "text": "perform remote code execution (RCE) attacks", "endOffset": 445, "role": {"CAPEC-Meta": "Code Inclusion", "type": "Capabilities", "confidence": 0.9498045742511749}, "startOffset": 402, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E10", "type": "Vulnerability-related", "realis": "Other", "nugget": {"startOffset": 645, "index": "T33", "endOffset": 654, "text": "exploited"}, "argument": [{"index": "T34", "text": "vulnerability", "endOffset": 609, "role": {"type": "Vulnerability"}, "startOffset": 596, "type": "Vulnerability"}, {"index": "T35", "text": "cause a client crash", "endOffset": 641, "role": {"CAPEC-Meta": "Forced Deadlock", "type": "Capabilities", "confidence": 0.9341460764408112}, "startOffset": 621, "type": "Capabilities"}], "subtype": "DiscoverVulnerability"}, {"index": "E7", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1627, "index": "T22", "endOffset": 1639, "text": "was reported"}, "argument": [{"index": "T24", "external_reference": {"wikidataid": "Q193559"}, "endOffset": 1648, "role": {"type": "Vulnerable_System_Owner"}, "text": "Valve", "startOffset": 1643, "type": "Organization"}, {"index": "T25", "text": "20 February", "endOffset": 1663, "role": {"type": "Time"}, "startOffset": 1652, "type": "Time"}, {"index": "T23", "text": "The vulnerability", "endOffset": 1626, "role": {"type": "Vulnerability"}, "startOffset": 1609, "type": "Vulnerability"}], "subtype": "DiscoverVulnerability"}]}, {"index": 1, "relation": "Same", "events": [{"index": "E9", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1733, "index": "T29", "endOffset": 1748, "text": "was then pushed"}, "argument": [{"index": "T31", "text": "a stable release", "endOffset": 1768, "role": {"type": "Patch"}, "startOffset": 1752, "type": "Patch"}, {"index": "T32", "text": "22 March", "endOffset": 1780, "role": {"type": "Time"}, "startOffset": 1772, "type": "Time"}, {"index": "T30", "text": "This patch", "endOffset": 1732, "role": {"type": "Patch"}, "startOffset": 1722, "type": "Patch"}], "subtype": "PatchVulnerability"}, {"index": "E8", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 1668, "index": "T26", "endOffset": 1677, "text": "was fixed"}, "argument": [{"index": "T27", "text": "a beta release", "endOffset": 1695, "role": {"type": "Patch"}, "startOffset": 1681, "type": "Patch"}, {"index": "T28", "text": "12 hours later", "endOffset": 1720, "role": {"type": "Time"}, "startOffset": 1706, "type": "Time"}], "subtype": "PatchVulnerability"}, {"nugget": {"startOffset": 353, "index": "T21", "endOffset": 367, "text": "left unpatched"}, "index": "E6", "type": "Vulnerability-related", "subtype": "PatchVulnerability", "realis": "Other"}, {"index": "E1", "type": "Vulnerability-related", "realis": "Actual", "nugget": {"startOffset": 6, "index": "T1", "endOffset": 17, "text": "has patched"}, "argument": [{"index": "T3", "text": "a critical vulnerability", "endOffset": 42, "role": {"type": "Vulnerability"}, "startOffset": 18, "type": "Vulnerability"}, {"index": "T2", "external_reference": {"wikidataid": "Q193559"}, "endOffset": 5, "role": {"type": "Releaser"}, "text": "Valve", "startOffset": 0, "type": "Organization"}, {"index": "T4", "external_reference": {"wikidataid": "Q337535"}, "endOffset": 62, "role": {"type": "Vulnerable_System"}, "text": "the Steam client", "startOffset": 46, "type": "Software"}], "subtype": "PatchVulnerability"}]}]}, "info": {"title": "Decade-old remote code execution vulnerability patched in Valve Steam client", "date": "2018_06_01", "type": "text", "link": "https://www.zdnet.com/article/remote-code-execution-vulnerability-patched-in-valve-steam-client/"}}