{"content": "This week researchers found a piece of malware in the wild, built to steal passwords from the macOS keychain. Named \"MacDownloader\" and posing as, what else, a fake Flash Player update, the new malware\u00a0was found on the Mac of a human rights advocate and believed to originate from Iran. The malware's code is very sloppy and appears to have been made by an amateur who\u00a0took pieces of other's code and repurposed them. The threat report mentions the following: MacDownloader seems to be poorly developed and created towards the end of 2016, potentially a first attempt from an amateur developer. In multiple cases, the code used has been copied from elsewhere. The simple activity of downloading the remote file appears to have been sourced from a cheat sheet. The main purpose of MacDownloader seems to be to perform an initial profiling of the infected system and collection of credentials from macOS\u2019s Keychain password manager \u2013 which mirrors the focus of Windows malware developed by the same actors. At this time, it appears the malware is not a threat and the Command & Control server has been taken down. Intego VirusBarrier offers protection from this malware, detected as OSX/MacDownloader. Security researchers found that this malware was originally designed as a fake Bitdefender antivirus, but was later repackaged as a fake Flash Player update. Once installed, the\u00a0malware attempts to achieve persistence by use of a poorly implemented shell script, which at the time of writing did not function due to the C&C server being offline. MacDownloader displays a fake Flash Player update that offers an \"Update Flash-Player\" button and a \"Close\" button. Unlike other malware of its kind, clicking the Close button actually exists the installer and nothing malicious is placed on the system. If the Update button is clicked though, a malware dialog will pop-up, which is, of course, fake as well. These dialogues are also rife with basic typos and grammatical errors, indicating that the developer paid little attention to quality control. After a user clicks on OK, the software mimics the System Preferences to request the admin password in order to grab more info on the system. If the user enters their password and clicks OK, the software grabs the info, and then it tries to open a remote connection to: MacDownloader collects user keychain information and uploads it to said C&C server, including documents the running processes, installed applications and the username and password, which are acquired through a\u00a0fake System Preferences dialog. The name and password, which in almost all cases are Administrator credentials, give the malware everything it needs to access the keychain information. With access to the keychain the sky is the limit, because email account passwords, social network account details, and much more, are all\u00a0stored in the keychain.", "sourcefile": "577.txt", "cyberevent": {"hopper": [{"index": 0, "relation": "Same", "events": [{"index": "E4", "type": "Attack", "realis": "General", "nugget": {"startOffset": 1245, "index": "T12", "endOffset": 1271, "text": "was originally designed as"}, "argument": [{"index": "T13", "text": "this malware", "endOffset": 1244, "role": {"type": "Tool"}, "startOffset": 1232, "type": "Malware"}, {"index": "T31", "text": "a fake Bitdefender antivirus", "endOffset": 1300, "role": {"type": "Trusted-Entity"}, "startOffset": 1272, "type": "Software"}], "subtype": "Phishing"}, {"index": "E5", "type": "Attack", "realis": "General", "nugget": {"startOffset": 1306, "index": "T14", "endOffset": 1329, "text": "was later repackaged as"}, "argument": [{"index": "T32", "external_reference": {"wikidataid": "Q857177"}, "endOffset": 1356, "role": {"type": "Trusted-Entity"}, "text": "a fake Flash Player update", "startOffset": 1330, "type": "Software"}], "subtype": "Phishing"}]}, {"index": 1, "events": [{"index": "E8", "type": "Attack", "realis": "General", "nugget": {"startOffset": 2717, "index": "T19", "endOffset": 2723, "text": "access"}, "argument": [{"index": "T24", "text": "email account passwords", "endOffset": 2793, "role": {"type": "Compromised-Data"}, "startOffset": 2770, "type": "PII"}, {"index": "T25", "text": "account details", "endOffset": 2825, "role": {"type": "Compromised-Data"}, "startOffset": 2810, "type": "PII"}, {"index": "T23", "text": "keychain", "endOffset": 2739, "role": {"type": "Victim"}, "startOffset": 2731, "type": "System"}], "subtype": "Databreach"}]}, {"index": 2, "events": [{"index": "E2", "type": "Attack", "realis": "General", "nugget": {"startOffset": 136, "index": "T5", "endOffset": 145, "text": "posing as"}, "argument": [{"index": "T7", "text": "MacDownloader", "endOffset": 130, "role": {"type": "Tool"}, "startOffset": 117, "type": "Malware"}, {"index": "T6", "external_reference": {"wikidataid": "Q857177"}, "endOffset": 184, "role": {"type": "Trusted-Entity"}, "text": "a fake Flash Player update", "startOffset": 158, "type": "Software"}], "subtype": "Phishing"}]}, {"index": 3, "events": [{"index": "E1", "type": "Attack", "realis": "Actual", "nugget": {"startOffset": 69, "index": "T1", "endOffset": 74, "text": "steal"}, "argument": [{"index": "T4", "text": "malware", "endOffset": 46, "role": {"type": "Tool"}, "startOffset": 39, "type": "Malware"}, {"index": "T2", "text": "passwords", "endOffset": 84, "role": {"type": "Compromised-Data"}, "startOffset": 75, "type": "PII"}, {"index": "T3", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/MacOS"}, "endOffset": 108, "role": {"type": "Victim"}, "text": "the macOS keychain", "startOffset": 90, "type": "System"}, {"index": "T26", "text": "This week", "endOffset": 9, "role": {"type": "Time"}, "startOffset": 0, "type": "Time"}], "subtype": "Databreach"}]}, {"index": 4, "events": [{"index": "E6", "type": "Attack", "realis": "General", "nugget": {"startOffset": 1560, "index": "T15", "endOffset": 1568, "text": "displays"}, "argument": [{"index": "T16", "text": "MacDownloader", "endOffset": 1559, "role": {"type": "Tool"}, "startOffset": 1546, "type": "Malware"}, {"index": "T17", "text": "offers an \"Update Flash-Player\" button and a \"Close\" button", "endOffset": 1660, "role": {"CAPEC-Meta": "Content Spoofing", "type": "Attack-Pattern", "confidence": 0.8393699824810028}, "startOffset": 1601, "type": "Capabilities"}, {"index": "T33", "external_reference": {"wikidataid": "Q857177"}, "endOffset": 1595, "role": {"type": "Trusted-Entity"}, "text": "a fake Flash Player update", "startOffset": 1569, "type": "Software"}], "subtype": "Phishing"}]}, {"index": 5, "events": [{"index": "E3", "type": "Attack", "realis": "General", "nugget": {"startOffset": 865, "index": "T8", "endOffset": 875, "text": "collection"}, "argument": [{"index": "T11", "text": "MacDownloader", "endOffset": 793, "role": {"type": "Tool"}, "startOffset": 780, "type": "Malware"}, {"index": "T9", "text": "credentials", "endOffset": 890, "role": {"type": "Compromised-Data"}, "startOffset": 879, "type": "PII"}, {"index": "T10", "external_reference": {"dbpediaURI": "http://dbpedia.org/resource/MacOS"}, "endOffset": 929, "role": {"type": "Victim"}, "text": "macOS\u2019s Keychain password manager", "startOffset": 896, "type": "System"}], "subtype": "Databreach"}]}, {"index": 6, "events": [{"index": "E7", "type": "Attack", "realis": "General", "nugget": {"startOffset": 2331, "index": "T20", "endOffset": 2339, "text": "collects"}, "argument": [{"index": "T22", "text": "MacDownloader", "endOffset": 2330, "role": {"type": "Tool"}, "startOffset": 2317, "type": "Malware"}, {"index": "T21", "text": "user keychain information", "endOffset": 2365, "role": {"type": "Compromised-Data"}, "startOffset": 2340, "type": "Data"}, {"index": "T18", "text": "acquired through a\u00a0fake System Preferences dialog", "endOffset": 2557, "role": {"CAPEC-Meta": "Exploitation of Trusted Credentials", "type": "Attack-Pattern", "confidence": 0.8665739297866821}, "startOffset": 2508, "type": "Capabilities"}], "subtype": "Databreach"}]}]}, "info": {"title": "New Malware Underscores the Danger of Assumed Mac Security | The Mac Security Blog", "date": "2017_02_09", "type": "text", "link": "https://www.intego.com/mac-security-blog/new-malware-underscores-the-danger-of-assumed-mac-security/"}}